2025-08-13 15:11:37,918 p=4217 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ************************************************
2025-08-13 15:11:37,924 p=4217 u=runner n=ansible INFO| TASK [Gathering Facts] *********************************************************
2025-08-13 15:11:38,836 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:38,841 p=4217 u=runner n=ansible INFO| TASK [创建日志目录] ************************************************************
2025-08-13 15:11:39,112 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,118 p=4217 u=runner n=ansible INFO| TASK [初始化监控结果变量] ******************************************************
2025-08-13 15:11:39,125 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,131 p=4217 u=runner n=ansible INFO| TASK [执行代理监控任务] ********************************************************
2025-08-13 15:11:39,151 p=4217 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 15:11:39,156 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] ******************************
2025-08-13 15:11:39,179 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,184 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ****************************************
2025-08-13 15:11:39,205 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,211 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] ******************************************
2025-08-13 15:11:39,221 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,227 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ****************************
2025-08-13 15:11:39,233 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ********************************************
2025-08-13 15:11:39,238 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ****************************************
2025-08-13 15:11:39,246 p=4217 u=runner n=ansible INFO| TASK [计算总体统计信息] ********************************************************
2025-08-13 15:11:39,251 p=4217 u=runner n=ansible INFO| TASK [显示监控汇总] ************************************************************
2025-08-13 15:11:39,255 p=4217 u=runner n=ansible INFO| TASK [发送告警邮件] ************************************************************
2025-08-13 15:11:39,260 p=4217 u=runner n=ansible INFO| TASK [监控状态总结] ************************************************************
2025-08-13 15:11:39,260 p=4217 u=runner n=ansible INFO| PLAY RECAP *********************************************************************
2025-08-13 15:11:39,260 p=4217 u=runner n=ansible INFO| localhost                  : ok=7    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-08-13 15:11:39,261 p=4217 u=runner n=ansible ERROR| ERROR! Unexpected Exception, this is probably a bug: [Errno 32] Broken pipe
2025-08-13 15:11:39,261 p=4217 u=runner n=ansible INFO| to see the full traceback, use -vvv
2025-08-13 15:11:39,435 p=4217 u=runner n=ansible INFO| the full traceback was:

Traceback (most recent call last):
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/cli/__init__.py", line 646, in cli_executor
    exit_code = cli.run()
                ^^^^^^^^^
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/cli/playbook.py", line 155, in run
    results = pbex.run()
              ^^^^^^^^^^
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/executor/playbook_executor.py", line 252, in run
    self._tqm.cleanup()
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/executor/task_queue_manager.py", line 365, in cleanup
    sys.stdout.flush()
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/utils/display.py", line 199, in locking_wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
BrokenPipeError: [Errno 32] Broken pipe

2025-08-13 15:12:52,932 p=4382 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 15:12:52,932 p=4382 u=runner n=ansible INFO|   play #1 (localhost): 代理状态和网站连通性监控	TAGS: []
2025-08-13 15:12:52,933 p=4382 u=runner n=ansible INFO|     tasks:
      创建日志目录	TAGS: []
      初始化监控结果变量	TAGS: []
      执行代理监控任务	TAGS: []
      计算总体统计信息	TAGS: []
      显示监控汇总	TAGS: []
      发送告警邮件	TAGS: []
      监控状态总结	TAGS: []

2025-08-13 15:13:12,703 p=4388 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:04:51,099 p=3352 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:06:26,348 p=3423 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:06:37,072 p=3430 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 16:06:37,154 p=3430 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 16:06:38,515 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,520 p=3430 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 16:06:38,803 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,816 p=3430 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 16:06:38,823 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,828 p=3430 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 16:06:38,847 p=3430 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:06:38,852 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 16:06:38,930 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,935 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 16:06:38,954 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,959 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 16:06:38,968 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,973 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 16:06:38,995 p=3430 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 16:06:38,998 p=3430 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 16:06:39,004 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:06:39,013 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:39,019 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:06:39,279 p=3430 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:06:39,438 p=3430 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:06:39,598 p=3430 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:06:39,758 p=3430 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:06:39,760 p=3430 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:06:39,765 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:06:39,796 p=3430 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"msg": "An unhandled exception occurred while templating '{'website': '{{ website_test_result.results[item_index].website_item.inventory_hostname if website_test_result.results is defined else test_websites[item_index].inventory_hostname }}', 'url': '{{ website_test_result.results[item_index].website_item.test_url if website_test_result.results is defined else test_websites[item_index].test_url }}', 'status': \"{{ 'SUCCESS' if website_test_result.results is defined and curl_return_code == 0 and curl_status_code | int in status_codes.success else 'FAILED' }}\", 'status_code': \"{{ curl_status_code | int if curl_status_code != '000' else -1 }}\", 'response_time': \"{{ (curl_time_total | float * 1000) | round(2) if curl_time_total != '0' else -1 }}\", 'error_msg': \"{{ 'curl错误码: ' + curl_error if curl_error != '' else ('HTTP错误: ' + curl_status_code if curl_return_code != 0 else '') }}\", 'timestamp': '{{ current_timestamp }}'}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ curl_output | regex_search('CURL_STATUS_CODE:(\\d+)', '\\1') | first | default('000') }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: Unexpected templating type error occurred on ({{ curl_output | regex_search('CURL_STATUS_CODE:(\\\\d+)', '\\\\1') | first | default('000') }}): 'NoneType' object is not iterable. 'NoneType' object is not iterable"}
2025-08-13 16:06:39,797 p=3430 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 16:06:39,797 p=3430 u=runner n=ansible INFO| localhost                  : ok=10   changed=0    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2025-08-13 16:07:38,926 p=3685 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:07:50,093 p=3690 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 16:07:50,098 p=3690 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 16:07:50,954 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:50,958 p=3690 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 16:07:51,213 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,218 p=3690 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 16:07:51,226 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,231 p=3690 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 16:07:51,249 p=3690 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:07:51,254 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 16:07:51,276 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,281 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 16:07:51,303 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,309 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 16:07:51,321 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,327 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 16:07:51,349 p=3690 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 16:07:51,353 p=3690 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 16:07:51,358 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:07:51,368 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,373 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:07:51,619 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:07:51,779 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:07:51,940 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:07:52,100 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:07:52,102 p=3690 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:07:52,107 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:07:52,209 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 16:07:52,291 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 16:07:52,374 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 16:07:52,459 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 16:07:52,466 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 16:07:52,485 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 16:07:52,488 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 16:07:52,490 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 16:07:52,493 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 16:07:52,494 p=3690 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:07:52,499 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 16:07:52,515 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:52,520 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 16:07:52,535 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:52,541 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 16:07:52,559 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:52,566 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:07:52,575 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:52,581 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:07:52,759 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:07:52,918 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:07:53,082 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:07:53,243 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:07:53,245 p=3690 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:07:53,250 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:07:53,351 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 16:07:53,436 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 16:07:53,520 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 16:07:53,604 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 16:07:53,611 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 16:07:53,630 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 16:07:53,632 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 16:07:53,634 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 16:07:53,637 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 16:07:53,638 p=3690 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:07:53,643 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 16:07:53,660 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:53,665 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 16:07:53,680 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:53,686 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 16:07:53,703 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:53,709 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 16:07:53,996 p=3690 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:07:54,002 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 16:07:54,032 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:54,043 p=3690 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 16:07:54,060 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:54,066 p=3690 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 16:07:54,078 p=3690 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T16:07:50Z",
        "总测试次数: 8",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 16:07:54,083 p=3690 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 16:07:54,240 p=3690 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:07:54,246 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 16:07:54,437 p=3690 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:07:54,443 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 16:07:54,518 p=3690 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"msg": "The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"}
2025-08-13 16:07:54,518 p=3690 u=runner n=ansible INFO| ...ignoring
2025-08-13 16:07:54,523 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 16:07:54,542 p=3690 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"
}
2025-08-13 16:07:54,551 p=3690 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 16:07:54,562 p=3690 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 16:07:54,562 p=3690 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 16:07:54,563 p=3690 u=runner n=ansible INFO| localhost                  : ok=28   changed=2    unreachable=0    failed=0    skipped=4    rescued=0    ignored=1   
2025-08-13 16:10:13,694 p=4199 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:10:23,785 p=4203 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 16:10:23,790 p=4203 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 16:10:24,646 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,650 p=4203 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 16:10:24,899 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,905 p=4203 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 16:10:24,912 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,917 p=4203 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 16:10:24,936 p=4203 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:10:24,941 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 16:10:24,962 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,967 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 16:10:24,986 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,991 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 16:10:25,001 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:25,006 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 16:10:25,028 p=4203 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 16:10:25,032 p=4203 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 16:10:25,037 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:10:25,046 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:25,052 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:10:25,300 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:10:25,460 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:10:25,621 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:10:25,783 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:10:25,784 p=4203 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:10:25,790 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:10:25,888 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 16:10:25,967 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 16:10:26,049 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 16:10:26,130 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 16:10:26,136 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 16:10:26,155 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 16:10:26,157 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 16:10:26,160 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 16:10:26,162 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 16:10:26,164 p=4203 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:10:26,169 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 16:10:26,185 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:26,191 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 16:10:26,205 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:26,210 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 16:10:26,228 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:26,235 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:10:26,245 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:26,250 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:10:26,430 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:10:26,588 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:10:26,748 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:10:26,908 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:10:26,909 p=4203 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:10:26,915 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:10:27,012 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 16:10:27,092 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 16:10:27,173 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 16:10:27,254 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 16:10:27,261 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 16:10:27,280 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 16:10:27,282 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 16:10:27,285 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 16:10:27,287 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 16:10:27,288 p=4203 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:10:27,293 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 16:10:27,309 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,316 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 16:10:27,331 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,336 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 16:10:27,353 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,359 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 16:10:27,639 p=4203 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:10:27,645 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 16:10:27,675 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,687 p=4203 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 16:10:27,704 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,709 p=4203 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 16:10:27,720 p=4203 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T16:10:24Z",
        "总测试次数: 8",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 16:10:27,725 p=4203 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 16:10:27,763 p=4203 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:10:27,770 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 16:10:27,956 p=4203 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:10:27,962 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 16:10:27,975 p=4203 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"msg": "The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"}
2025-08-13 16:10:27,975 p=4203 u=runner n=ansible INFO| ...ignoring
2025-08-13 16:10:27,981 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 16:10:27,998 p=4203 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"
}
2025-08-13 16:10:28,007 p=4203 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 16:10:28,017 p=4203 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 16:10:28,018 p=4203 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 16:10:28,018 p=4203 u=runner n=ansible INFO| localhost                  : ok=28   changed=2    unreachable=0    failed=0    skipped=4    rescued=0    ignored=1   
2025-08-13 16:11:31,652 p=4622 u=runner n=ansible INFO| PLAY [测试curl集成] ****************************************************************************************************
2025-08-13 16:11:31,657 p=4622 u=runner n=ansible INFO| TASK [测试curl命令执行和输出解析] **************************************************************************************
2025-08-13 16:11:31,920 p=4622 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:11:31,921 p=4622 u=runner n=ansible INFO| TASK [显示curl执行结果] ************************************************************************************************
2025-08-13 16:11:31,932 p=4622 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "Return code: 5",
        "Stdout: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001156",
        "Stderr: "
    ]
}
2025-08-13 16:11:31,933 p=4622 u=runner n=ansible INFO| TASK [解析curl输出] ****************************************************************************************************
2025-08-13 16:11:31,947 p=4622 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:11:31,948 p=4622 u=runner n=ansible INFO| TASK [显示解析结果] ****************************************************************************************************
2025-08-13 16:11:31,958 p=4622 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "Status match: ['000']",
        "Time match: ['0.001156']",
        "Status code: 000",
        "Time: 0.001156"
    ]
}
2025-08-13 16:11:31,959 p=4622 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 16:11:31,959 p=4622 u=runner n=ansible INFO| localhost                  : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-08-13 16:12:50,356 p=4684 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 23:49:42,239 p=3424 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 23:50:11,291 p=3459 u=runner n=ansible INFO| Using /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg as config file
2025-08-13 23:50:11,475 p=3459 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 23:50:11,579 p=3459 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 23:50:13,095 p=3459 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:50:13,100 p=3459 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 23:50:13,370 p=3459 u=runner n=ansible INFO| ok: [localhost] => {"changed": false, "gid": 118, "group": "docker", "mode": "0755", "owner": "runner", "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs", "size": 4096, "state": "directory", "uid": 1001}
2025-08-13 23:50:13,381 p=3459 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 23:50:13,389 p=3459 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"monitoring_results": []}, "changed": false}
2025-08-13 23:50:13,395 p=3459 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 23:50:13,414 p=3459 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:50:13,419 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 23:50:13,488 p=3459 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"enabled_proxies": [{"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy1", "inventory_hostname_short": "proxy1", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass1", "proxy_url": "http://proxy1.example.com:8080", "proxy_username": "user1"}, {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy2", "inventory_hostname_short": "proxy2", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass2", "proxy_url": "http://proxy2.example.com:8080", "proxy_username": "user2"}]}, "changed": false}
2025-08-13 23:50:13,493 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 23:50:13,514 p=3459 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"test_websites": [{"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}, {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}, {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}, {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}]}, "changed": false}
2025-08-13 23:50:13,519 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 23:50:13,529 p=3459 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"current_timestamp": "2025-08-13T23:50:12Z", "proxy_test_results": {}}, "changed": false}
2025-08-13 23:50:13,535 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 23:50:13,559 p=3459 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 23:50:13,563 p=3459 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 23:50:13,568 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:50:13,579 p=3459 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy1", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:50:13,588 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:50:13,884 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=google)  => {"ansible_loop_var": "website_item", "changed": false, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.google.com\"\n", "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": [], "website_item": {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:50:14,045 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=github)  => {"ansible_loop_var": "website_item", "changed": false, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://github.com\"\n", "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": [], "website_item": {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:50:14,212 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu)  => {"ansible_loop_var": "website_item", "changed": false, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": [], "website_item": {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:50:14,374 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin)  => {"ansible_loop_var": "website_item", "changed": false, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": [], "website_item": {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:50:14,376 p=3459 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:50:14,382 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:50:14,484 p=3459 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:50:14,567 p=3459 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:50:14,651 p=3459 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:50:14,737 p=3459 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:50:14,745 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 调试模式输出] ************************************************************************************
2025-08-13 23:50:14,764 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "false_condition": "debug_mode | default(false) | bool", "item_index": 0}
2025-08-13 23:50:14,766 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "false_condition": "debug_mode | default(false) | bool", "item_index": 1}
2025-08-13 23:50:14,768 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "false_condition": "debug_mode | default(false) | bool", "item_index": 2}
2025-08-13 23:50:14,771 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "false_condition": "debug_mode | default(false) | bool", "item_index": 3}
2025-08-13 23:50:14,772 p=3459 u=runner n=ansible INFO| skipping: [localhost] => {"msg": "All items skipped"}
2025-08-13 23:50:14,778 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:50:14,799 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:50:14,801 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:50:14,803 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:50:14,806 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:50:14,807 p=3459 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:50:14,813 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:50:14,844 p=3459 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY", "proxy_success_rate": "0.0", "proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": 0.0, "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:50:12Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:50:14,850 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试结果] ********************************************************************************
2025-08-13 23:50:14,872 p=3459 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "代理地址: http://proxy1.example.com:8080",
        "状态: UNHEALTHY",
        "成功率: 0.0%",
        "测试结果: 0/4 成功",
        "",
        "网站测试结果:",
        "  • google (https://www.google.com) - 状态: FAILED, 响应时间: -1ms, HTTP状态码: -1  • github (https://github.com) - 状态: FAILED, 响应时间: -1ms, HTTP状态码: -1  • baidu (https://www.baidu.com) - 状态: FAILED, 响应时间: -1ms, HTTP状态码: -1  • httpbin (https://httpbin.org/status/200) - 状态: FAILED, 响应时间: -1ms, HTTP状态码: -1"
    ]
}
2025-08-13 23:50:14,880 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:50:14,892 p=3459 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy2", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:50:14,897 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:50:15,094 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=google)  => {"ansible_loop_var": "website_item", "changed": false, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.google.com\"\n", "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": [], "website_item": {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:50:15,265 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=github)  => {"ansible_loop_var": "website_item", "changed": false, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://github.com\"\n", "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": [], "website_item": {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:50:15,436 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu)  => {"ansible_loop_var": "website_item", "changed": false, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": [], "website_item": {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:50:15,611 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin)  => {"ansible_loop_var": "website_item", "changed": false, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": null, "end": null, "msg": "Command would have run if not in check mode", "rc": 0, "start": null, "stderr": "", "stderr_lines": [], "stdout": "", "stdout_lines": [], "website_item": {"ansible_check_mode": true, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:50:15,612 p=3459 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:50:15,618 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:50:15,722 p=3459 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:50:15,804 p=3459 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:50:15,891 p=3459 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:50:15,974 p=3459 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:50:15,981 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 调试模式输出] ************************************************************************************
2025-08-13 23:50:16,000 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "false_condition": "debug_mode | default(false) | bool", "item_index": 0}
2025-08-13 23:50:16,002 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "false_condition": "debug_mode | default(false) | bool", "item_index": 1}
2025-08-13 23:50:16,004 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "false_condition": "debug_mode | default(false) | bool", "item_index": 2}
2025-08-13 23:50:16,007 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "false_condition": "debug_mode | default(false) | bool", "item_index": 3}
2025-08-13 23:50:16,007 p=3459 u=runner n=ansible INFO| skipping: [localhost] => {"msg": "All items skipped"}
2025-08-13 23:50:16,014 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:50:16,036 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:50:16,038 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:50:16,041 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:50:16,044 p=3459 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:50:16,044 p=3459 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:50:16,050 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:50:16,082 p=3459 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY", "proxy_success_rate": "0.0", "proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": 0.0, "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:50:12Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": 0.0, "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:50:12Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:50:12Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:50:16,088 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试结果] ********************************************************************************
2025-08-13 23:50:16,109 p=3459 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "代理地址: http://proxy2.example.com:8080",
        "状态: UNHEALTHY",
        "成功率: 0.0%",
        "测试结果: 0/4 成功",
        "",
        "网站测试结果:",
        "  • google (https://www.google.com) - 状态: FAILED, 响应时间: -1ms, HTTP状态码: -1  • github (https://github.com) - 状态: FAILED, 响应时间: -1ms, HTTP状态码: -1  • baidu (https://www.baidu.com) - 状态: FAILED, 响应时间: -1ms, HTTP状态码: -1  • httpbin (https://httpbin.org/status/200) - 状态: FAILED, 响应时间: -1ms, HTTP状态码: -1"
    ]
}
2025-08-13 23:50:16,115 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 23:50:16,417 p=3459 u=runner n=ansible INFO| changed: [localhost] => {"changed": true}
2025-08-13 23:50:16,428 p=3459 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 23:50:16,596 p=3459 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:50:16,603 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 23:50:16,805 p=3459 u=runner n=ansible INFO| changed: [localhost] => {"changed": true}
2025-08-13 23:50:16,811 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 23:50:16,838 p=3459 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"msg": "The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"}
2025-08-13 23:50:16,838 p=3459 u=runner n=ansible INFO| ...ignoring
2025-08-13 23:50:16,844 p=3459 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 23:50:16,863 p=3459 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"
}
2025-08-13 23:50:16,873 p=3459 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 23:50:16,885 p=3459 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 23:50:16,886 p=3459 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 23:50:16,886 p=3459 u=runner n=ansible INFO| localhost                  : ok=23   changed=2    unreachable=0    failed=0    skipped=6    rescued=0    ignored=1   
2025-08-13 23:51:03,199 p=3878 u=runner n=ansible INFO| Using /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg as config file
2025-08-13 23:51:03,347 p=3878 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 23:51:03,347 p=3878 u=runner n=ansible INFO| skipping: no hosts matched
2025-08-13 23:51:03,347 p=3878 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 23:51:13,446 p=3883 u=runner n=ansible INFO| Using /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg as config file
2025-08-13 23:51:13,595 p=3883 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 23:51:13,601 p=3883 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 23:51:14,468 p=3883 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:51:14,472 p=3883 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 23:51:14,726 p=3883 u=runner n=ansible INFO| ok: [localhost] => {"changed": false, "gid": 118, "group": "docker", "mode": "0755", "owner": "runner", "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs", "size": 4096, "state": "directory", "uid": 1001}
2025-08-13 23:51:14,732 p=3883 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 23:51:14,739 p=3883 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"monitoring_results": []}, "changed": false}
2025-08-13 23:51:14,744 p=3883 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 23:51:14,761 p=3883 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:51:14,766 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 23:51:14,788 p=3883 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"enabled_proxies": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy1", "inventory_hostname_short": "proxy1", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass1", "proxy_url": "http://proxy1.example.com:8080", "proxy_username": "user1"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy2", "inventory_hostname_short": "proxy2", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass2", "proxy_url": "http://proxy2.example.com:8080", "proxy_username": "user2"}]}, "changed": false}
2025-08-13 23:51:14,793 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 23:51:14,812 p=3883 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"test_websites": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}]}, "changed": false}
2025-08-13 23:51:14,817 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 23:51:14,827 p=3883 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"current_timestamp": "2025-08-13T23:51:14Z", "proxy_test_results": {}}, "changed": false}
2025-08-13 23:51:14,832 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 23:51:14,854 p=3883 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 23:51:14,858 p=3883 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 23:51:14,863 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:51:14,873 p=3883 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy1", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:51:14,878 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:51:15,140 p=3883 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010778", "end": "2025-08-13 23:51:15.121057", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:51:15.110279", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001163", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001163"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:51:15,312 p=3883 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.010172", "end": "2025-08-13 23:51:15.294028", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:51:15.283856", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001198", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001198"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:51:15,495 p=3883 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.013601", "end": "2025-08-13 23:51:15.471181", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:51:15.457580", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001583", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001583"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:51:15,669 p=3883 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.009724", "end": "2025-08-13 23:51:15.651113", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:51:15.641389", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001169", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001169"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:51:15,676 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:51:15,776 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:51:15,857 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:51:15,940 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.58", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:51:16,021 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.58", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:51:16,028 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 调试模式输出] ************************************************************************************
2025-08-13 23:51:16,061 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001163",
        "解析的状态码: 000",
        "解析的响应时间: 0.001163",
        "网站: google"
    ]
}
2025-08-13 23:51:16,074 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001198",
        "解析的状态码: 000",
        "解析的响应时间: 0.001198",
        "网站: github"
    ]
}
2025-08-13 23:51:16,090 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001583",
        "解析的状态码: 000",
        "解析的响应时间: 0.001583",
        "网站: baidu"
    ]
}
2025-08-13 23:51:16,104 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001169",
        "解析的状态码: 000",
        "解析的响应时间: 0.001169",
        "网站: httpbin"
    ]
}
2025-08-13 23:51:16,110 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:51:16,129 p=3883 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:51:16,131 p=3883 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:51:16,134 p=3883 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:51:16,137 p=3883 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:51:16,138 p=3883 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:51:16,143 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:51:16,173 p=3883 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY", "proxy_success_rate": "0.0", "proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": 0.0, "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.58", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:51:14Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:51:16,179 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试结果] ********************************************************************************
2025-08-13 23:51:16,198 p=3883 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "代理地址: http://proxy1.example.com:8080",
        "状态: UNHEALTHY",
        "成功率: 0.0%",
        "测试结果: 0/4 成功",
        "",
        "网站测试结果:",
        "  • google (https://www.google.com) - 状态: FAILED, 响应时间: 1.16ms, HTTP状态码: -1  • github (https://github.com) - 状态: FAILED, 响应时间: 1.2ms, HTTP状态码: -1  • baidu (https://www.baidu.com) - 状态: FAILED, 响应时间: 1.58ms, HTTP状态码: -1  • httpbin (https://httpbin.org/status/200) - 状态: FAILED, 响应时间: 1.17ms, HTTP状态码: -1"
    ]
}
2025-08-13 23:51:16,205 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:51:16,215 p=3883 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy2", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:51:16,220 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:51:16,408 p=3883 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.009850", "end": "2025-08-13 23:51:16.389771", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:51:16.379921", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001159", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001159"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:51:16,586 p=3883 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.010841", "end": "2025-08-13 23:51:16.566290", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:51:16.555449", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001168", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001168"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:51:16,765 p=3883 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.010187", "end": "2025-08-13 23:51:16.746342", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:51:16.736155", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001179", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001179"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:51:16,943 p=3883 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010300", "end": "2025-08-13 23:51:16.923923", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:51:16.913623", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001179", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001179"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:51:16,950 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:51:17,052 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:51:17,134 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:51:17,217 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.18", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:51:17,298 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.18", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.18", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:51:17,305 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 调试模式输出] ************************************************************************************
2025-08-13 23:51:17,340 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001159",
        "解析的状态码: 000",
        "解析的响应时间: 0.001159",
        "网站: google"
    ]
}
2025-08-13 23:51:17,353 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001168",
        "解析的状态码: 000",
        "解析的响应时间: 0.001168",
        "网站: github"
    ]
}
2025-08-13 23:51:17,368 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001179",
        "解析的状态码: 000",
        "解析的响应时间: 0.001179",
        "网站: baidu"
    ]
}
2025-08-13 23:51:17,382 p=3883 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001179",
        "解析的状态码: 000",
        "解析的响应时间: 0.001179",
        "网站: httpbin"
    ]
}
2025-08-13 23:51:17,389 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:51:17,410 p=3883 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:51:17,413 p=3883 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:51:17,415 p=3883 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:51:17,418 p=3883 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:51:17,419 p=3883 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:51:17,424 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:51:17,454 p=3883 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY", "proxy_success_rate": "0.0", "proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": 0.0, "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.58", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:51:14Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": 0.0, "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.18", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.18", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:51:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:51:14Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:51:17,459 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试结果] ********************************************************************************
2025-08-13 23:51:17,477 p=3883 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "代理地址: http://proxy2.example.com:8080",
        "状态: UNHEALTHY",
        "成功率: 0.0%",
        "测试结果: 0/4 成功",
        "",
        "网站测试结果:",
        "  • google (https://www.google.com) - 状态: FAILED, 响应时间: 1.16ms, HTTP状态码: -1  • github (https://github.com) - 状态: FAILED, 响应时间: 1.17ms, HTTP状态码: -1  • baidu (https://www.baidu.com) - 状态: FAILED, 响应时间: 1.18ms, HTTP状态码: -1  • httpbin (https://httpbin.org/status/200) - 状态: FAILED, 响应时间: 1.18ms, HTTP状态码: -1"
    ]
}
2025-08-13 23:51:17,483 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 23:51:18,017 p=3883 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "7ef156dcd657eaba0641852ec2e46ea1ba2c19ff", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log", "gid": 118, "group": "docker", "md5sum": "5eedeb4d6246b9a96fc58f08be504c6e", "mode": "0644", "owner": "runner", "size": 1935, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755129077.4950922-4242-110399989191547/.source.log", "state": "file", "uid": 1001}
2025-08-13 23:51:18,027 p=3883 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 23:51:18,070 p=3883 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:51:18,077 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 23:51:18,417 p=3883 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "60dd990d6416f7f5110d05c380ff1e6f9b612e81", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html", "gid": 118, "group": "docker", "md5sum": "0624c0dfc0491c819c3fa357e60ae15d", "mode": "0644", "owner": "runner", "size": 8362, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755129078.089059-4280-90133865863236/.source.html", "state": "file", "uid": 1001}
2025-08-13 23:51:18,423 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 23:51:18,730 p=3883 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 23:51:18,730 p=3883 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755129078.4440217-4317-227605291802198/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755129078.4440217-4317-227605291802198/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755129078.4440217-4317-227605291802198/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_j_smd8kr/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_j_smd8kr/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 23:51:18,730 p=3883 u=runner n=ansible INFO| ...ignoring
2025-08-13 23:51:18,736 p=3883 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 23:51:18,753 p=3883 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 23:51:18,762 p=3883 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 23:51:18,772 p=3883 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 23:51:18,773 p=3883 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 23:51:18,773 p=3883 u=runner n=ansible INFO| localhost                  : ok=27   changed=4    unreachable=0    failed=0    skipped=2    rescued=0    ignored=1   
2025-08-13 23:52:13,832 p=4376 u=runner n=ansible INFO| Using /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg as config file
2025-08-13 23:52:13,976 p=4376 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ************************************************
2025-08-13 23:52:13,981 p=4376 u=runner n=ansible INFO| TASK [Gathering Facts] *********************************************************
2025-08-13 23:52:14,835 p=4376 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:52:14,840 p=4376 u=runner n=ansible INFO| TASK [创建日志目录] ************************************************************
2025-08-13 23:52:15,094 p=4376 u=runner n=ansible INFO| ok: [localhost] => {"changed": false, "gid": 118, "group": "docker", "mode": "0755", "owner": "runner", "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs", "size": 4096, "state": "directory", "uid": 1001}
2025-08-13 23:52:15,099 p=4376 u=runner n=ansible INFO| TASK [初始化监控结果变量] ******************************************************
2025-08-13 23:52:15,106 p=4376 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"monitoring_results": []}, "changed": false}
2025-08-13 23:52:15,111 p=4376 u=runner n=ansible INFO| TASK [执行代理监控任务] ********************************************************
2025-08-13 23:52:15,129 p=4376 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:52:15,134 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] ******************************
2025-08-13 23:52:15,155 p=4376 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"enabled_proxies": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy1", "inventory_hostname_short": "proxy1", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass1", "proxy_url": "http://proxy1.example.com:8080", "proxy_username": "user1"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy2", "inventory_hostname_short": "proxy2", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass2", "proxy_url": "http://proxy2.example.com:8080", "proxy_username": "user2"}]}, "changed": false}
2025-08-13 23:52:15,160 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ****************************************
2025-08-13 23:52:15,179 p=4376 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"test_websites": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}]}, "changed": false}
2025-08-13 23:52:15,184 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] ******************************************
2025-08-13 23:52:15,193 p=4376 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"current_timestamp": "2025-08-13T23:52:14Z", "proxy_test_results": {}}, "changed": false}
2025-08-13 23:52:15,198 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ****************************
2025-08-13 23:52:15,220 p=4376 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 23:52:15,224 p=4376 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 23:52:15,229 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 23:52:15,239 p=4376 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy1", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:52:15,244 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 23:52:15,500 p=4376 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010060", "end": "2025-08-13 23:52:15.482435", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:52:15.472375", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001129", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001129"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:52:15,673 p=4376 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.010296", "end": "2025-08-13 23:52:15.655248", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:52:15.644952", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001160", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001160"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:52:15,847 p=4376 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.010118", "end": "2025-08-13 23:52:15.829485", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:52:15.819367", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001173", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001173"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:52:16,018 p=4376 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010074", "end": "2025-08-13 23:52:16.000192", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:52:15.990118", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001162", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001162"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:52:16,025 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 23:52:16,124 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "", "response_time": "1.13", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:52:16,203 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "", "response_time": "1.13", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:52:16,284 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "", "response_time": "1.13", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:52:16,364 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "", "response_time": "1.13", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:52:16,371 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 调试模式输出] ********************************************
2025-08-13 23:52:16,405 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001129",
        "解析的状态码: 000",
        "解析的响应时间: 0.001129",
        "网站: google"
    ]
}
2025-08-13 23:52:16,418 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001160",
        "解析的状态码: 000",
        "解析的响应时间: 0.001160",
        "网站: github"
    ]
}
2025-08-13 23:52:16,433 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001173",
        "解析的状态码: 000",
        "解析的响应时间: 0.001173",
        "网站: baidu"
    ]
}
2025-08-13 23:52:16,447 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001162",
        "解析的状态码: 000",
        "解析的响应时间: 0.001162",
        "网站: httpbin"
    ]
}
2025-08-13 23:52:16,453 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 23:52:16,474 p=4376 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:52:16,476 p=4376 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:52:16,478 p=4376 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:52:16,481 p=4376 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:52:16,481 p=4376 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:52:16,487 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 23:52:16,516 p=4376 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY", "proxy_success_rate": "0.0", "proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": 0.0, "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.13", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:52:14Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:52:16,521 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试结果] ****************************************
2025-08-13 23:52:16,541 p=4376 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "代理地址: http://proxy1.example.com:8080",
        "状态: UNHEALTHY",
        "成功率: 0.0%",
        "测试结果: 0/4 成功",
        "",
        "网站测试结果:",
        "  • google (https://www.google.com) - 状态: FAILED, 响应时间: 1.13ms, HTTP状态码: -1  • github (https://github.com) - 状态: FAILED, 响应时间: 1.16ms, HTTP状态码: -1  • baidu (https://www.baidu.com) - 状态: FAILED, 响应时间: 1.17ms, HTTP状态码: -1  • httpbin (https://httpbin.org/status/200) - 状态: FAILED, 响应时间: 1.16ms, HTTP状态码: -1"
    ]
}
2025-08-13 23:52:16,548 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 23:52:16,559 p=4376 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy2", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:52:16,564 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 23:52:16,763 p=4376 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.015433", "end": "2025-08-13 23:52:16.741093", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:52:16.725660", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001173", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001173"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:52:16,938 p=4376 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.010863", "end": "2025-08-13 23:52:16.919609", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:52:16.908746", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001164", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001164"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:52:17,116 p=4376 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.009946", "end": "2025-08-13 23:52:17.097212", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:52:17.087266", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001172", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001172"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:52:17,289 p=4376 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -s -k     --suppress-connect-headers     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     -w \"HTTP_CODE:%{http_code},TIME_TOTAL:%{time_total}\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.009622", "end": "2025-08-13 23:52:17.270749", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:52:17.261127", "stderr": "", "stderr_lines": [], "stdout": "HTTP_CODE:000,TIME_TOTAL:0.001126", "stdout_lines": ["HTTP_CODE:000,TIME_TOTAL:0.001126"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "debug_mode": "true", "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:52:17,296 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 23:52:17,395 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:52:17,477 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:52:17,559 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:52:17,643 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.13", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:52:17,650 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 调试模式输出] ********************************************
2025-08-13 23:52:17,682 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001173",
        "解析的状态码: 000",
        "解析的响应时间: 0.001173",
        "网站: google"
    ]
}
2025-08-13 23:52:17,695 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001164",
        "解析的状态码: 000",
        "解析的响应时间: 0.001164",
        "网站: github"
    ]
}
2025-08-13 23:52:17,709 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001172",
        "解析的状态码: 000",
        "解析的响应时间: 0.001172",
        "网站: baidu"
    ]
}
2025-08-13 23:52:17,722 p=4376 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {
    "msg": [
        "curl返回码: 5",
        "curl输出: HTTP_CODE:000,TIME_TOTAL:0.001126",
        "解析的状态码: 000",
        "解析的响应时间: 0.001126",
        "网站: httpbin"
    ]
}
2025-08-13 23:52:17,729 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 23:52:17,749 p=4376 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:52:17,751 p=4376 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:52:17,754 p=4376 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:52:17,756 p=4376 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:52:17,757 p=4376 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:52:17,762 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 23:52:17,791 p=4376 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY", "proxy_success_rate": "0.0", "proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": 0.0, "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.13", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:52:14Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": 0.0, "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.17", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.13", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:52:14Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:52:14Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:52:17,796 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试结果] ****************************************
2025-08-13 23:52:17,815 p=4376 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "代理地址: http://proxy2.example.com:8080",
        "状态: UNHEALTHY",
        "成功率: 0.0%",
        "测试结果: 0/4 成功",
        "",
        "网站测试结果:",
        "  • google (https://www.google.com) - 状态: FAILED, 响应时间: 1.17ms, HTTP状态码: -1  • github (https://github.com) - 状态: FAILED, 响应时间: 1.16ms, HTTP状态码: -1  • baidu (https://www.baidu.com) - 状态: FAILED, 响应时间: 1.17ms, HTTP状态码: -1  • httpbin (https://httpbin.org/status/200) - 状态: FAILED, 响应时间: 1.13ms, HTTP状态码: -1"
    ]
}
2025-08-13 23:52:17,821 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ********************************************
2025-08-13 23:52:18,360 p=4376 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "56c3fe8022e039bf0fc916f043cfafc463e1c7de", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log", "gid": 118, "group": "docker", "md5sum": "334b7ad728e6072c4dc0da5146299f36", "mode": "0644", "owner": "runner", "size": 1936, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755129137.8331003-4736-126734725419132/.source.log", "state": "file", "uid": 1001}
2025-08-13 23:52:18,370 p=4376 u=runner n=ansible INFO| TASK [发送告警邮件] ************************************************************
2025-08-13 23:52:18,412 p=4376 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:52:18,418 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ****************************************
2025-08-13 23:52:18,773 p=4376 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "3d86243cb80a53221b4070ac3930ebea5ce77555", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html", "gid": 118, "group": "docker", "md5sum": "d18f7806b67182ccf2faa8e60785ab1d", "mode": "0644", "owner": "runner", "size": 8363, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755129138.4302263-4776-146618959362593/.source.html", "state": "file", "uid": 1001}
2025-08-13 23:52:18,779 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ********************************************
2025-08-13 23:52:19,057 p=4376 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 23:52:19,057 p=4376 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755129138.7997842-4815-161275006060123/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755129138.7997842-4815-161275006060123/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755129138.7997842-4815-161275006060123/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_5kemof8t/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_5kemof8t/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 23:52:19,057 p=4376 u=runner n=ansible INFO| ...ignoring
2025-08-13 23:52:19,063 p=4376 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ****************************************
2025-08-13 23:52:19,080 p=4376 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 23:52:19,090 p=4376 u=runner n=ansible INFO| TASK [监控状态总结] ************************************************************
2025-08-13 23:52:19,100 p=4376 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 23:52:19,101 p=4376 u=runner n=ansible INFO| PLAY RECAP *********************************************************************
2025-08-13 23:52:19,101 p=4376 u=runner n=ansible INFO| localhost                  : ok=27   changed=4    unreachable=0    failed=0    skipped=2    rescued=0    ignored=1   
2025-08-13 23:53:02,627 p=4863 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
