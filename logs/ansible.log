2025-08-13 15:11:37,918 p=4217 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ************************************************
2025-08-13 15:11:37,924 p=4217 u=runner n=ansible INFO| TASK [Gathering Facts] *********************************************************
2025-08-13 15:11:38,836 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:38,841 p=4217 u=runner n=ansible INFO| TASK [创建日志目录] ************************************************************
2025-08-13 15:11:39,112 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,118 p=4217 u=runner n=ansible INFO| TASK [初始化监控结果变量] ******************************************************
2025-08-13 15:11:39,125 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,131 p=4217 u=runner n=ansible INFO| TASK [执行代理监控任务] ********************************************************
2025-08-13 15:11:39,151 p=4217 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 15:11:39,156 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] ******************************
2025-08-13 15:11:39,179 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,184 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ****************************************
2025-08-13 15:11:39,205 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,211 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] ******************************************
2025-08-13 15:11:39,221 p=4217 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 15:11:39,227 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ****************************
2025-08-13 15:11:39,233 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ********************************************
2025-08-13 15:11:39,238 p=4217 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ****************************************
2025-08-13 15:11:39,246 p=4217 u=runner n=ansible INFO| TASK [计算总体统计信息] ********************************************************
2025-08-13 15:11:39,251 p=4217 u=runner n=ansible INFO| TASK [显示监控汇总] ************************************************************
2025-08-13 15:11:39,255 p=4217 u=runner n=ansible INFO| TASK [发送告警邮件] ************************************************************
2025-08-13 15:11:39,260 p=4217 u=runner n=ansible INFO| TASK [监控状态总结] ************************************************************
2025-08-13 15:11:39,260 p=4217 u=runner n=ansible INFO| PLAY RECAP *********************************************************************
2025-08-13 15:11:39,260 p=4217 u=runner n=ansible INFO| localhost                  : ok=7    changed=0    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-08-13 15:11:39,261 p=4217 u=runner n=ansible ERROR| ERROR! Unexpected Exception, this is probably a bug: [Errno 32] Broken pipe
2025-08-13 15:11:39,261 p=4217 u=runner n=ansible INFO| to see the full traceback, use -vvv
2025-08-13 15:11:39,435 p=4217 u=runner n=ansible INFO| the full traceback was:

Traceback (most recent call last):
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/cli/__init__.py", line 646, in cli_executor
    exit_code = cli.run()
                ^^^^^^^^^
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/cli/playbook.py", line 155, in run
    results = pbex.run()
              ^^^^^^^^^^
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/executor/playbook_executor.py", line 252, in run
    self._tqm.cleanup()
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/executor/task_queue_manager.py", line 365, in cleanup
    sys.stdout.flush()
  File "/opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/utils/display.py", line 199, in locking_wrapper
    return f(*args, **kwargs)
           ^^^^^^^^^^^^^^^^^^
BrokenPipeError: [Errno 32] Broken pipe

2025-08-13 15:12:52,932 p=4382 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 15:12:52,932 p=4382 u=runner n=ansible INFO|   play #1 (localhost): 代理状态和网站连通性监控	TAGS: []
2025-08-13 15:12:52,933 p=4382 u=runner n=ansible INFO|     tasks:
      创建日志目录	TAGS: []
      初始化监控结果变量	TAGS: []
      执行代理监控任务	TAGS: []
      计算总体统计信息	TAGS: []
      显示监控汇总	TAGS: []
      发送告警邮件	TAGS: []
      监控状态总结	TAGS: []

2025-08-13 15:13:12,703 p=4388 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:04:51,099 p=3352 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:06:26,348 p=3423 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:06:37,072 p=3430 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 16:06:37,154 p=3430 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 16:06:38,515 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,520 p=3430 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 16:06:38,803 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,816 p=3430 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 16:06:38,823 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,828 p=3430 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 16:06:38,847 p=3430 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:06:38,852 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 16:06:38,930 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,935 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 16:06:38,954 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,959 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 16:06:38,968 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:38,973 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 16:06:38,995 p=3430 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 16:06:38,998 p=3430 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 16:06:39,004 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:06:39,013 p=3430 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:06:39,019 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:06:39,279 p=3430 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:06:39,438 p=3430 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:06:39,598 p=3430 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:06:39,758 p=3430 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:06:39,760 p=3430 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:06:39,765 p=3430 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:06:39,796 p=3430 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"msg": "An unhandled exception occurred while templating '{'website': '{{ website_test_result.results[item_index].website_item.inventory_hostname if website_test_result.results is defined else test_websites[item_index].inventory_hostname }}', 'url': '{{ website_test_result.results[item_index].website_item.test_url if website_test_result.results is defined else test_websites[item_index].test_url }}', 'status': \"{{ 'SUCCESS' if website_test_result.results is defined and curl_return_code == 0 and curl_status_code | int in status_codes.success else 'FAILED' }}\", 'status_code': \"{{ curl_status_code | int if curl_status_code != '000' else -1 }}\", 'response_time': \"{{ (curl_time_total | float * 1000) | round(2) if curl_time_total != '0' else -1 }}\", 'error_msg': \"{{ 'curl错误码: ' + curl_error if curl_error != '' else ('HTTP错误: ' + curl_status_code if curl_return_code != 0 else '') }}\", 'timestamp': '{{ current_timestamp }}'}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: An unhandled exception occurred while templating '{{ curl_output | regex_search('CURL_STATUS_CODE:(\\d+)', '\\1') | first | default('000') }}'. Error was a <class 'ansible.errors.AnsibleError'>, original message: Unexpected templating type error occurred on ({{ curl_output | regex_search('CURL_STATUS_CODE:(\\\\d+)', '\\\\1') | first | default('000') }}): 'NoneType' object is not iterable. 'NoneType' object is not iterable"}
2025-08-13 16:06:39,797 p=3430 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 16:06:39,797 p=3430 u=runner n=ansible INFO| localhost                  : ok=10   changed=0    unreachable=0    failed=1    skipped=1    rescued=0    ignored=0   
2025-08-13 16:07:38,926 p=3685 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:07:50,093 p=3690 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 16:07:50,098 p=3690 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 16:07:50,954 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:50,958 p=3690 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 16:07:51,213 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,218 p=3690 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 16:07:51,226 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,231 p=3690 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 16:07:51,249 p=3690 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:07:51,254 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 16:07:51,276 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,281 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 16:07:51,303 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,309 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 16:07:51,321 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,327 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 16:07:51,349 p=3690 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 16:07:51,353 p=3690 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 16:07:51,358 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:07:51,368 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:51,373 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:07:51,619 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:07:51,779 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:07:51,940 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:07:52,100 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:07:52,102 p=3690 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:07:52,107 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:07:52,209 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 16:07:52,291 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 16:07:52,374 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 16:07:52,459 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 16:07:52,466 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 16:07:52,485 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 16:07:52,488 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 16:07:52,490 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 16:07:52,493 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 16:07:52,494 p=3690 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:07:52,499 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 16:07:52,515 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:52,520 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 16:07:52,535 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:52,541 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 16:07:52,559 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:52,566 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:07:52,575 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:52,581 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:07:52,759 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:07:52,918 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:07:53,082 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:07:53,243 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:07:53,245 p=3690 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:07:53,250 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:07:53,351 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 16:07:53,436 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 16:07:53,520 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 16:07:53,604 p=3690 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 16:07:53,611 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 16:07:53,630 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 16:07:53,632 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 16:07:53,634 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 16:07:53,637 p=3690 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 16:07:53,638 p=3690 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:07:53,643 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 16:07:53,660 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:53,665 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 16:07:53,680 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:53,686 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 16:07:53,703 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:53,709 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 16:07:53,996 p=3690 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:07:54,002 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 16:07:54,032 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:54,043 p=3690 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 16:07:54,060 p=3690 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:07:54,066 p=3690 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 16:07:54,078 p=3690 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T16:07:50Z",
        "总测试次数: 8",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 16:07:54,083 p=3690 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 16:07:54,240 p=3690 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:07:54,246 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 16:07:54,437 p=3690 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:07:54,443 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 16:07:54,518 p=3690 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"msg": "The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"}
2025-08-13 16:07:54,518 p=3690 u=runner n=ansible INFO| ...ignoring
2025-08-13 16:07:54,523 p=3690 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 16:07:54,542 p=3690 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"
}
2025-08-13 16:07:54,551 p=3690 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 16:07:54,562 p=3690 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 16:07:54,562 p=3690 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 16:07:54,563 p=3690 u=runner n=ansible INFO| localhost                  : ok=28   changed=2    unreachable=0    failed=0    skipped=4    rescued=0    ignored=1   
2025-08-13 16:10:13,694 p=4199 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 16:10:23,785 p=4203 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 16:10:23,790 p=4203 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 16:10:24,646 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,650 p=4203 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 16:10:24,899 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,905 p=4203 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 16:10:24,912 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,917 p=4203 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 16:10:24,936 p=4203 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:10:24,941 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 16:10:24,962 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,967 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 16:10:24,986 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:24,991 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 16:10:25,001 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:25,006 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 16:10:25,028 p=4203 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 16:10:25,032 p=4203 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 16:10:25,037 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:10:25,046 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:25,052 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:10:25,300 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:10:25,460 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:10:25,621 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:10:25,783 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:10:25,784 p=4203 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:10:25,790 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:10:25,888 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 16:10:25,967 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 16:10:26,049 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 16:10:26,130 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 16:10:26,136 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 16:10:26,155 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 16:10:26,157 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 16:10:26,160 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 16:10:26,162 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 16:10:26,164 p=4203 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:10:26,169 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 16:10:26,185 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:26,191 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 16:10:26,205 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:26,210 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 16:10:26,228 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:26,235 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 16:10:26,245 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:26,250 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 16:10:26,430 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=google) 
2025-08-13 16:10:26,588 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=github) 
2025-08-13 16:10:26,748 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=baidu) 
2025-08-13 16:10:26,908 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=httpbin) 
2025-08-13 16:10:26,909 p=4203 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:10:26,915 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 16:10:27,012 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 16:10:27,092 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 16:10:27,173 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 16:10:27,254 p=4203 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 16:10:27,261 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 16:10:27,280 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 16:10:27,282 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 16:10:27,285 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 16:10:27,287 p=4203 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 16:10:27,288 p=4203 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 16:10:27,293 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 16:10:27,309 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,316 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 16:10:27,331 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,336 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 16:10:27,353 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,359 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 16:10:27,639 p=4203 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:10:27,645 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 16:10:27,675 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,687 p=4203 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 16:10:27,704 p=4203 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:10:27,709 p=4203 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 16:10:27,720 p=4203 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T16:10:24Z",
        "总测试次数: 8",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 16:10:27,725 p=4203 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 16:10:27,763 p=4203 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 16:10:27,770 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 16:10:27,956 p=4203 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:10:27,962 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 16:10:27,975 p=4203 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"msg": "The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"}
2025-08-13 16:10:27,975 p=4203 u=runner n=ansible INFO| ...ignoring
2025-08-13 16:10:27,981 p=4203 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 16:10:27,998 p=4203 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: The 'file' lookup had an issue accessing the file '/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html'. file not found, use -vvvvv to see paths searched"
}
2025-08-13 16:10:28,007 p=4203 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 16:10:28,017 p=4203 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 16:10:28,018 p=4203 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 16:10:28,018 p=4203 u=runner n=ansible INFO| localhost                  : ok=28   changed=2    unreachable=0    failed=0    skipped=4    rescued=0    ignored=1   
2025-08-13 16:11:31,652 p=4622 u=runner n=ansible INFO| PLAY [测试curl集成] ****************************************************************************************************
2025-08-13 16:11:31,657 p=4622 u=runner n=ansible INFO| TASK [测试curl命令执行和输出解析] **************************************************************************************
2025-08-13 16:11:31,920 p=4622 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 16:11:31,921 p=4622 u=runner n=ansible INFO| TASK [显示curl执行结果] ************************************************************************************************
2025-08-13 16:11:31,932 p=4622 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "Return code: 5",
        "Stdout: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001156",
        "Stderr: "
    ]
}
2025-08-13 16:11:31,933 p=4622 u=runner n=ansible INFO| TASK [解析curl输出] ****************************************************************************************************
2025-08-13 16:11:31,947 p=4622 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 16:11:31,948 p=4622 u=runner n=ansible INFO| TASK [显示解析结果] ****************************************************************************************************
2025-08-13 16:11:31,958 p=4622 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "Status match: ['000']",
        "Time match: ['0.001156']",
        "Status code: 000",
        "Time: 0.001156"
    ]
}
2025-08-13 16:11:31,959 p=4622 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 16:11:31,959 p=4622 u=runner n=ansible INFO| localhost                  : ok=4    changed=1    unreachable=0    failed=0    skipped=0    rescued=0    ignored=0   
2025-08-13 16:12:50,356 p=4684 u=runner n=ansible INFO| playbook: playbooks/monitor-proxies.yml
2025-08-13 22:52:22,088 p=3371 u=runner n=ansible INFO| Using /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg as config file
2025-08-13 22:52:22,664 p=3371 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 22:52:22,711 p=3371 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 22:52:24,082 p=3371 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:52:24,087 p=3371 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 22:52:24,427 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"changed": false, "gid": 118, "group": "docker", "mode": "0755", "owner": "runner", "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs", "size": 4096, "state": "directory", "uid": 1001}
2025-08-13 22:52:24,439 p=3371 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 22:52:24,447 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_proxies": [], "monitoring_results": [], "successful_tests": 0, "total_tests": 0}, "changed": false}
2025-08-13 22:52:24,452 p=3371 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 22:52:24,471 p=3371 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:52:24,476 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 22:52:24,540 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"enabled_proxies": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy1", "inventory_hostname_short": "proxy1", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass1", "proxy_url": "http://proxy1.example.com:8080", "proxy_username": "user1"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy2", "inventory_hostname_short": "proxy2", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass2", "proxy_url": "http://proxy2.example.com:8080", "proxy_username": "user2"}]}, "changed": false}
2025-08-13 22:52:24,545 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 22:52:24,566 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"test_websites": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}]}, "changed": false}
2025-08-13 22:52:24,572 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 22:52:24,582 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"current_timestamp": "2025-08-13T22:52:23Z", "proxy_test_results": {}}, "changed": false}
2025-08-13 22:52:24,587 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 22:52:24,610 p=3371 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 22:52:24,614 p=3371 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 22:52:24,619 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 22:52:24,630 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy1", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 22:52:24,636 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 22:52:24,943 p=3371 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010837", "end": "2025-08-13 22:52:24.923135", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:52:24.912298", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001202", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001202"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 22:52:25,120 p=3371 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.009816", "end": "2025-08-13 22:52:25.100838", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:52:25.091022", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001161", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001161"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 22:52:25,308 p=3371 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.011951", "end": "2025-08-13 22:52:25.283822", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:52:25.271871", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001367", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001367"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 22:52:25,483 p=3371 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010088", "end": "2025-08-13 22:52:25.464983", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:52:25.454895", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001480", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001480"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 22:52:25,490 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 22:52:25,592 p=3371 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 22:52:25,673 p=3371 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 22:52:25,754 p=3371 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.37", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 22:52:25,839 p=3371 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.37", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.48", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 22:52:25,846 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 22:52:25,867 p=3371 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 22:52:25,869 p=3371 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 22:52:25,872 p=3371 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 22:52:25,875 p=3371 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 22:52:25,876 p=3371 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 22:52:25,882 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 22:52:25,900 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 22:52:25,906 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 22:52:25,922 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 22:52:25,928 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 22:52:25,948 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.37", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.48", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:52:23Z", "total_tests": 4}}}, "changed": false}
2025-08-13 22:52:25,956 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 22:52:25,967 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy2", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 22:52:25,973 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 22:52:26,172 p=3371 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010193", "end": "2025-08-13 22:52:26.151288", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:52:26.141095", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001156", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001156"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 22:52:26,348 p=3371 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.010333", "end": "2025-08-13 22:52:26.328274", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:52:26.317941", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001154", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001154"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 22:52:26,528 p=3371 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.010532", "end": "2025-08-13 22:52:26.508242", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:52:26.497710", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001178", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001178"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 22:52:26,706 p=3371 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010185", "end": "2025-08-13 22:52:26.685729", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:52:26.675544", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001159", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001159"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 22:52:26,713 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 22:52:26,814 p=3371 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 22:52:26,897 p=3371 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.15", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 22:52:26,979 p=3371 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.15", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.18", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 22:52:27,059 p=3371 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.15", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.18", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 22:52:27,067 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 22:52:27,087 p=3371 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 22:52:27,089 p=3371 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 22:52:27,092 p=3371 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 22:52:27,094 p=3371 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 22:52:27,095 p=3371 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 22:52:27,100 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 22:52:27,118 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 22:52:27,123 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 22:52:27,139 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 22:52:27,144 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 22:52:27,162 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.37", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.48", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:52:23Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.15", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.18", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:52:23Z", "total_tests": 4}}}, "changed": false}
2025-08-13 22:52:27,168 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 22:52:27,708 p=3371 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "702fb3ee80ecf4ae8b3881db3df0aef6b0d06aaa", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log", "gid": 118, "group": "docker", "md5sum": "3cedac3a22c07c45188c2339ffd84f01", "mode": "0644", "owner": "runner", "size": 1935, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755125547.1804092-3730-13098078661333/.source.log", "state": "file", "uid": 1001}
2025-08-13 22:52:27,713 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 22:52:27,746 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_proxies": [], "monitoring_results": [{"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.2", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.37", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.48", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:52:23Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "", "response_time": "1.15", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://github.com", "website": "github"}, {"error_msg": "", "response_time": "1.18", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "", "response_time": "1.16", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:52:23Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:52:23Z", "total_tests": 4}}], "successful_tests": "NotImplemented", "total_tests": "8"}, "changed": false}
2025-08-13 22:52:27,758 p=3371 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 22:52:27,777 p=3371 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"overall_success_rate": "0.0", "total_failed_proxies": "0"}, "changed": false}
2025-08-13 22:52:27,783 p=3371 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 22:52:27,796 p=3371 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T22:52:23Z",
        "总测试次数: 8",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 22:52:27,801 p=3371 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 22:52:27,910 p=3371 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:52:27,917 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 22:52:28,268 p=3371 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "e27ff13b465014b5ef86f8d20bfaeea04385fa36", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html", "gid": 118, "group": "docker", "md5sum": "0b6167b307a372b74bea0b5320f66b9e", "mode": "0644", "owner": "runner", "size": 8362, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755125547.9296649-3772-94554667220561/.source.html", "state": "file", "uid": 1001}
2025-08-13 22:52:28,274 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 22:52:28,616 p=3371 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 22:52:28,617 p=3371 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125548.3296854-3809-174205926519779/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125548.3296854-3809-174205926519779/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125548.3296854-3809-174205926519779/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_oaruw3aq/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_oaruw3aq/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 22:52:28,617 p=3371 u=runner n=ansible INFO| ...ignoring
2025-08-13 22:52:28,622 p=3371 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 22:52:28,641 p=3371 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 22:52:28,651 p=3371 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 22:52:28,662 p=3371 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 22:52:28,663 p=3371 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 22:52:28,664 p=3371 u=runner n=ansible INFO| localhost                  : ok=30   changed=4    unreachable=0    failed=0    skipped=2    rescued=0    ignored=1   
2025-08-13 22:52:52,647 p=3840 u=runner n=ansible INFO| ansible-playbook [core 2.18.7]
  config file = /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg
  configured module search path = ['/home/runner/.ansible/plugins/modules', '/usr/share/ansible/plugins/modules']
  ansible python module location = /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible
  ansible collection location = /home/runner/.ansible/collections:/usr/share/ansible/collections
  executable location = /opt/pipx_bin/ansible-playbook
  python version = 3.12.3 (main, Jun 18 2025, 17:59:45) [GCC 13.3.0] (/opt/pipx/venvs/ansible-core/bin/python)
  jinja version = 3.1.6
  libyaml = True
2025-08-13 22:52:52,647 p=3840 u=runner n=ansible INFO| Using /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg as config file
2025-08-13 22:52:52,733 p=3840 u=runner n=ansible INFO| host_list declined parsing /home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml as it did not pass its verify_file() method
2025-08-13 22:52:52,734 p=3840 u=runner n=ansible INFO| script declined parsing /home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml as it did not pass its verify_file() method
2025-08-13 22:52:52,736 p=3840 u=runner n=ansible INFO| Parsed /home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml inventory source with yaml plugin
2025-08-13 22:52:52,798 p=3840 u=runner n=ansible INFO| Skipping callback 'default', as we already have a stdout callback.
2025-08-13 22:52:52,798 p=3840 u=runner n=ansible INFO| Skipping callback 'minimal', as we already have a stdout callback.
2025-08-13 22:52:52,798 p=3840 u=runner n=ansible INFO| Skipping callback 'oneline', as we already have a stdout callback.
2025-08-13 22:52:52,798 p=3840 u=runner n=ansible INFO| PLAYBOOK: monitor-proxies.yml **************************************************
2025-08-13 22:52:52,798 p=3840 u=runner n=ansible INFO| 1 plays in playbooks/monitor-proxies.yml
2025-08-13 22:52:52,799 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:52,800 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:52,800 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:52,801 p=3840 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ************************************************
2025-08-13 22:52:52,806 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:52,806 p=3840 u=runner n=ansible INFO| TASK [Gathering Facts] *********************************************************
2025-08-13 22:52:52,806 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/playbooks/monitor-proxies.yml:3
2025-08-13 22:52:52,814 p=3840 u=runner n=ansible INFO| <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: runner
2025-08-13 22:52:52,814 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:52,817 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125572.8171003-3845-219652068894534 `" && echo ansible-tmp-1755125572.8171003-3845-219652068894534="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125572.8171003-3845-219652068894534 `" ) && sleep 0'
2025-08-13 22:52:53,010 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/setup.py
2025-08-13 22:52:53,011 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpu7k3s9yu TO /home/runner/.ansible/tmp/ansible-tmp-1755125572.8171003-3845-219652068894534/AnsiballZ_setup.py
2025-08-13 22:52:53,011 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125572.8171003-3845-219652068894534/ /home/runner/.ansible/tmp/ansible-tmp-1755125572.8171003-3845-219652068894534/AnsiballZ_setup.py && sleep 0'
2025-08-13 22:52:53,015 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125572.8171003-3845-219652068894534/AnsiballZ_setup.py && sleep 0'
2025-08-13 22:52:53,663 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125572.8171003-3845-219652068894534/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:53,693 p=3840 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:52:53,698 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:53,698 p=3840 u=runner n=ansible INFO| TASK [创建日志目录] ************************************************************
2025-08-13 22:52:53,698 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/playbooks/monitor-proxies.yml:12
2025-08-13 22:52:53,708 p=3840 u=runner n=ansible INFO| <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: runner
2025-08-13 22:52:53,709 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:53,712 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125573.7118077-3947-226530178152386 `" && echo ansible-tmp-1755125573.7118077-3947-226530178152386="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125573.7118077-3947-226530178152386 `" ) && sleep 0'
2025-08-13 22:52:53,805 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/file.py
2025-08-13 22:52:53,806 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpqlyw4318 TO /home/runner/.ansible/tmp/ansible-tmp-1755125573.7118077-3947-226530178152386/AnsiballZ_file.py
2025-08-13 22:52:53,806 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125573.7118077-3947-226530178152386/ /home/runner/.ansible/tmp/ansible-tmp-1755125573.7118077-3947-226530178152386/AnsiballZ_file.py && sleep 0'
2025-08-13 22:52:53,810 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125573.7118077-3947-226530178152386/AnsiballZ_file.py && sleep 0'
2025-08-13 22:52:53,971 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125573.7118077-3947-226530178152386/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:53,976 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "changed": false,
    "diff": {
        "after": {
            "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs"
        },
        "before": {
            "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs"
        }
    },
    "gid": 118,
    "group": "docker",
    "invocation": {
        "module_args": {
            "_diff_peek": null,
            "_original_basename": null,
            "access_time": null,
            "access_time_format": "%Y%m%d%H%M.%S",
            "attributes": null,
            "follow": true,
            "force": false,
            "group": null,
            "mode": "0755",
            "modification_time": null,
            "modification_time_format": "%Y%m%d%H%M.%S",
            "owner": null,
            "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs",
            "recurse": false,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": null,
            "state": "directory",
            "unsafe_writes": false
        }
    },
    "mode": "0755",
    "owner": "runner",
    "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs",
    "size": 4096,
    "state": "directory",
    "uid": 1001
}
2025-08-13 22:52:53,982 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:53,982 p=3840 u=runner n=ansible INFO| TASK [初始化监控结果变量] ******************************************************
2025-08-13 22:52:53,982 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/playbooks/monitor-proxies.yml:18
2025-08-13 22:52:53,990 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "failed_proxies": [],
        "monitoring_results": [],
        "successful_tests": 0,
        "total_tests": 0
    },
    "changed": false
}
2025-08-13 22:52:53,995 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:53,995 p=3840 u=runner n=ansible INFO| TASK [执行代理监控任务] ********************************************************
2025-08-13 22:52:53,995 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/playbooks/monitor-proxies.yml:25
2025-08-13 22:52:54,005 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,008 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,009 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,012 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,014 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,015 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,015 p=3840 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:52:54,020 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,020 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] ******************************
2025-08-13 22:52:54,020 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/main.yml:4
2025-08-13 22:52:54,044 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "enabled_proxies": [
            {
                "ansible_check_mode": false,
                "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
                "ansible_diff_mode": false,
                "ansible_facts": {},
                "ansible_forks": 5,
                "ansible_host": "localhost",
                "ansible_inventory_sources": [
                    "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
                ],
                "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
                "ansible_run_tags": [
                    "all"
                ],
                "ansible_skip_tags": [],
                "ansible_verbosity": 3,
                "ansible_version": {
                    "full": "2.18.7",
                    "major": 2,
                    "minor": 18,
                    "revision": 7,
                    "string": "2.18.7"
                },
                "enabled": true,
                "group_names": [
                    "proxy_servers"
                ],
                "groups": {
                    "all": [
                        "proxy1",
                        "proxy2",
                        "proxy3",
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "proxy_servers": [
                        "proxy1",
                        "proxy2",
                        "proxy3"
                    ],
                    "test_websites": [
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "ungrouped": []
                },
                "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
                "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
                "inventory_hostname": "proxy1",
                "inventory_hostname_short": "proxy1",
                "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
                "proxy_password": "pass1",
                "proxy_url": "http://proxy1.example.com:8080",
                "proxy_username": "user1"
            },
            {
                "ansible_check_mode": false,
                "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
                "ansible_diff_mode": false,
                "ansible_facts": {},
                "ansible_forks": 5,
                "ansible_host": "localhost",
                "ansible_inventory_sources": [
                    "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
                ],
                "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
                "ansible_run_tags": [
                    "all"
                ],
                "ansible_skip_tags": [],
                "ansible_verbosity": 3,
                "ansible_version": {
                    "full": "2.18.7",
                    "major": 2,
                    "minor": 18,
                    "revision": 7,
                    "string": "2.18.7"
                },
                "enabled": true,
                "group_names": [
                    "proxy_servers"
                ],
                "groups": {
                    "all": [
                        "proxy1",
                        "proxy2",
                        "proxy3",
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "proxy_servers": [
                        "proxy1",
                        "proxy2",
                        "proxy3"
                    ],
                    "test_websites": [
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "ungrouped": []
                },
                "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
                "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
                "inventory_hostname": "proxy2",
                "inventory_hostname_short": "proxy2",
                "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
                "proxy_password": "pass2",
                "proxy_url": "http://proxy2.example.com:8080",
                "proxy_username": "user2"
            }
        ]
    },
    "changed": false
}
2025-08-13 22:52:54,049 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,050 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ****************************************
2025-08-13 22:52:54,050 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/main.yml:8
2025-08-13 22:52:54,072 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "test_websites": [
            {
                "ansible_check_mode": false,
                "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
                "ansible_diff_mode": false,
                "ansible_facts": {},
                "ansible_forks": 5,
                "ansible_inventory_sources": [
                    "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
                ],
                "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
                "ansible_run_tags": [
                    "all"
                ],
                "ansible_skip_tags": [],
                "ansible_verbosity": 3,
                "ansible_version": {
                    "full": "2.18.7",
                    "major": 2,
                    "minor": 18,
                    "revision": 7,
                    "string": "2.18.7"
                },
                "expected_status": 200,
                "group_names": [
                    "test_websites"
                ],
                "groups": {
                    "all": [
                        "proxy1",
                        "proxy2",
                        "proxy3",
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "proxy_servers": [
                        "proxy1",
                        "proxy2",
                        "proxy3"
                    ],
                    "test_websites": [
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "ungrouped": []
                },
                "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
                "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
                "inventory_hostname": "google",
                "inventory_hostname_short": "google",
                "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
                "request_timeout": 10,
                "test_url": "https://www.google.com"
            },
            {
                "ansible_check_mode": false,
                "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
                "ansible_diff_mode": false,
                "ansible_facts": {},
                "ansible_forks": 5,
                "ansible_inventory_sources": [
                    "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
                ],
                "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
                "ansible_run_tags": [
                    "all"
                ],
                "ansible_skip_tags": [],
                "ansible_verbosity": 3,
                "ansible_version": {
                    "full": "2.18.7",
                    "major": 2,
                    "minor": 18,
                    "revision": 7,
                    "string": "2.18.7"
                },
                "expected_status": 200,
                "group_names": [
                    "test_websites"
                ],
                "groups": {
                    "all": [
                        "proxy1",
                        "proxy2",
                        "proxy3",
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "proxy_servers": [
                        "proxy1",
                        "proxy2",
                        "proxy3"
                    ],
                    "test_websites": [
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "ungrouped": []
                },
                "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
                "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
                "inventory_hostname": "github",
                "inventory_hostname_short": "github",
                "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
                "request_timeout": 15,
                "test_url": "https://github.com"
            },
            {
                "ansible_check_mode": false,
                "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
                "ansible_diff_mode": false,
                "ansible_facts": {},
                "ansible_forks": 5,
                "ansible_inventory_sources": [
                    "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
                ],
                "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
                "ansible_run_tags": [
                    "all"
                ],
                "ansible_skip_tags": [],
                "ansible_verbosity": 3,
                "ansible_version": {
                    "full": "2.18.7",
                    "major": 2,
                    "minor": 18,
                    "revision": 7,
                    "string": "2.18.7"
                },
                "expected_status": 200,
                "group_names": [
                    "test_websites"
                ],
                "groups": {
                    "all": [
                        "proxy1",
                        "proxy2",
                        "proxy3",
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "proxy_servers": [
                        "proxy1",
                        "proxy2",
                        "proxy3"
                    ],
                    "test_websites": [
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "ungrouped": []
                },
                "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
                "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
                "inventory_hostname": "baidu",
                "inventory_hostname_short": "baidu",
                "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
                "request_timeout": 10,
                "test_url": "https://www.baidu.com"
            },
            {
                "ansible_check_mode": false,
                "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
                "ansible_diff_mode": false,
                "ansible_facts": {},
                "ansible_forks": 5,
                "ansible_inventory_sources": [
                    "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
                ],
                "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
                "ansible_run_tags": [
                    "all"
                ],
                "ansible_skip_tags": [],
                "ansible_verbosity": 3,
                "ansible_version": {
                    "full": "2.18.7",
                    "major": 2,
                    "minor": 18,
                    "revision": 7,
                    "string": "2.18.7"
                },
                "expected_status": 200,
                "group_names": [
                    "test_websites"
                ],
                "groups": {
                    "all": [
                        "proxy1",
                        "proxy2",
                        "proxy3",
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "proxy_servers": [
                        "proxy1",
                        "proxy2",
                        "proxy3"
                    ],
                    "test_websites": [
                        "google",
                        "github",
                        "baidu",
                        "httpbin"
                    ],
                    "ungrouped": []
                },
                "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
                "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
                "inventory_hostname": "httpbin",
                "inventory_hostname_short": "httpbin",
                "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
                "request_timeout": 5,
                "test_url": "https://httpbin.org/status/200"
            }
        ]
    },
    "changed": false
}
2025-08-13 22:52:54,077 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,078 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] ******************************************
2025-08-13 22:52:54,078 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/main.yml:12
2025-08-13 22:52:54,089 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "current_timestamp": "2025-08-13T22:52:53Z",
        "proxy_test_results": {}
    },
    "changed": false
}
2025-08-13 22:52:54,094 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,094 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ****************************
2025-08-13 22:52:54,094 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/main.yml:17
2025-08-13 22:52:54,116 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,121 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,121 p=3840 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 22:52:54,125 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,125 p=3840 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 22:52:54,130 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,131 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 22:52:54,131 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:4
2025-08-13 22:52:54,142 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "failed_count": 0,
        "proxy_name": "proxy1",
        "proxy_tests": [],
        "successful_count": 0
    },
    "changed": false
}
2025-08-13 22:52:54,147 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,148 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 22:52:54,148 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:11
2025-08-13 22:52:54,171 p=3840 u=runner n=ansible INFO| <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: runner
2025-08-13 22:52:54,171 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:54,174 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125574.1740406-3979-183924210037753 `" && echo ansible-tmp-1755125574.1740406-3979-183924210037753="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125574.1740406-3979-183924210037753 `" ) && sleep 0'
2025-08-13 22:52:54,253 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/command.py
2025-08-13 22:52:54,254 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmp6wk30o91 TO /home/runner/.ansible/tmp/ansible-tmp-1755125574.1740406-3979-183924210037753/AnsiballZ_command.py
2025-08-13 22:52:54,254 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125574.1740406-3979-183924210037753/ /home/runner/.ansible/tmp/ansible-tmp-1755125574.1740406-3979-183924210037753/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:54,258 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125574.1740406-3979-183924210037753/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:54,415 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125574.1740406-3979-183924210037753/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:54,421 p=3840 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {
    "ansible_loop_var": "website_item",
    "changed": true,
    "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n",
    "delta": "0:00:00.010370",
    "end": "2025-08-13 22:52:54.399560",
    "failed_when_result": false,
    "invocation": {
        "module_args": {
            "_raw_params": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "non-zero return code",
    "rc": 5,
    "start": "2025-08-13 22:52:54.389190",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001145",
    "stdout_lines": [
        "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001145"
    ],
    "website_item": {
        "ansible_check_mode": false,
        "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
        "ansible_diff_mode": false,
        "ansible_facts": {},
        "ansible_forks": 5,
        "ansible_inventory_sources": [
            "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
        ],
        "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
        "ansible_run_tags": [
            "all"
        ],
        "ansible_skip_tags": [],
        "ansible_verbosity": 3,
        "ansible_version": {
            "full": "2.18.7",
            "major": 2,
            "minor": 18,
            "revision": 7,
            "string": "2.18.7"
        },
        "expected_status": 200,
        "group_names": [
            "test_websites"
        ],
        "groups": {
            "all": [
                "proxy1",
                "proxy2",
                "proxy3",
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "proxy_servers": [
                "proxy1",
                "proxy2",
                "proxy3"
            ],
            "test_websites": [
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "ungrouped": []
        },
        "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
        "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
        "inventory_hostname": "google",
        "inventory_hostname_short": "google",
        "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
        "request_timeout": 10,
        "test_url": "https://www.google.com"
    }
}
2025-08-13 22:52:54,427 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:54,430 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125574.4303532-3979-257983838507843 `" && echo ansible-tmp-1755125574.4303532-3979-257983838507843="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125574.4303532-3979-257983838507843 `" ) && sleep 0'
2025-08-13 22:52:54,436 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/command.py
2025-08-13 22:52:54,436 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpehmck0jl TO /home/runner/.ansible/tmp/ansible-tmp-1755125574.4303532-3979-257983838507843/AnsiballZ_command.py
2025-08-13 22:52:54,437 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125574.4303532-3979-257983838507843/ /home/runner/.ansible/tmp/ansible-tmp-1755125574.4303532-3979-257983838507843/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:54,440 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125574.4303532-3979-257983838507843/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:54,596 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125574.4303532-3979-257983838507843/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:54,602 p=3840 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {
    "ansible_loop_var": "website_item",
    "changed": true,
    "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n",
    "delta": "0:00:00.010444",
    "end": "2025-08-13 22:52:54.581415",
    "failed_when_result": false,
    "invocation": {
        "module_args": {
            "_raw_params": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "non-zero return code",
    "rc": 5,
    "start": "2025-08-13 22:52:54.570971",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001165",
    "stdout_lines": [
        "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001165"
    ],
    "website_item": {
        "ansible_check_mode": false,
        "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
        "ansible_diff_mode": false,
        "ansible_facts": {},
        "ansible_forks": 5,
        "ansible_inventory_sources": [
            "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
        ],
        "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
        "ansible_run_tags": [
            "all"
        ],
        "ansible_skip_tags": [],
        "ansible_verbosity": 3,
        "ansible_version": {
            "full": "2.18.7",
            "major": 2,
            "minor": 18,
            "revision": 7,
            "string": "2.18.7"
        },
        "expected_status": 200,
        "group_names": [
            "test_websites"
        ],
        "groups": {
            "all": [
                "proxy1",
                "proxy2",
                "proxy3",
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "proxy_servers": [
                "proxy1",
                "proxy2",
                "proxy3"
            ],
            "test_websites": [
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "ungrouped": []
        },
        "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
        "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
        "inventory_hostname": "github",
        "inventory_hostname_short": "github",
        "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
        "request_timeout": 15,
        "test_url": "https://github.com"
    }
}
2025-08-13 22:52:54,608 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:54,610 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125574.6106439-3979-6427222455050 `" && echo ansible-tmp-1755125574.6106439-3979-6427222455050="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125574.6106439-3979-6427222455050 `" ) && sleep 0'
2025-08-13 22:52:54,616 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/command.py
2025-08-13 22:52:54,616 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmprmlffhsq TO /home/runner/.ansible/tmp/ansible-tmp-1755125574.6106439-3979-6427222455050/AnsiballZ_command.py
2025-08-13 22:52:54,617 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125574.6106439-3979-6427222455050/ /home/runner/.ansible/tmp/ansible-tmp-1755125574.6106439-3979-6427222455050/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:54,620 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125574.6106439-3979-6427222455050/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:54,774 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125574.6106439-3979-6427222455050/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:54,780 p=3840 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {
    "ansible_loop_var": "website_item",
    "changed": true,
    "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n",
    "delta": "0:00:00.010363",
    "end": "2025-08-13 22:52:54.759912",
    "failed_when_result": false,
    "invocation": {
        "module_args": {
            "_raw_params": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "non-zero return code",
    "rc": 5,
    "start": "2025-08-13 22:52:54.749549",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001177",
    "stdout_lines": [
        "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001177"
    ],
    "website_item": {
        "ansible_check_mode": false,
        "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
        "ansible_diff_mode": false,
        "ansible_facts": {},
        "ansible_forks": 5,
        "ansible_inventory_sources": [
            "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
        ],
        "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
        "ansible_run_tags": [
            "all"
        ],
        "ansible_skip_tags": [],
        "ansible_verbosity": 3,
        "ansible_version": {
            "full": "2.18.7",
            "major": 2,
            "minor": 18,
            "revision": 7,
            "string": "2.18.7"
        },
        "expected_status": 200,
        "group_names": [
            "test_websites"
        ],
        "groups": {
            "all": [
                "proxy1",
                "proxy2",
                "proxy3",
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "proxy_servers": [
                "proxy1",
                "proxy2",
                "proxy3"
            ],
            "test_websites": [
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "ungrouped": []
        },
        "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
        "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
        "inventory_hostname": "baidu",
        "inventory_hostname_short": "baidu",
        "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
        "request_timeout": 10,
        "test_url": "https://www.baidu.com"
    }
}
2025-08-13 22:52:54,786 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:54,789 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125574.789236-3979-249865392463923 `" && echo ansible-tmp-1755125574.789236-3979-249865392463923="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125574.789236-3979-249865392463923 `" ) && sleep 0'
2025-08-13 22:52:54,795 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/command.py
2025-08-13 22:52:54,795 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpmwglcoiu TO /home/runner/.ansible/tmp/ansible-tmp-1755125574.789236-3979-249865392463923/AnsiballZ_command.py
2025-08-13 22:52:54,795 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125574.789236-3979-249865392463923/ /home/runner/.ansible/tmp/ansible-tmp-1755125574.789236-3979-249865392463923/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:54,799 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125574.789236-3979-249865392463923/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:54,961 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125574.789236-3979-249865392463923/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:54,966 p=3840 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {
    "ansible_loop_var": "website_item",
    "changed": true,
    "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n",
    "delta": "0:00:00.011997",
    "end": "2025-08-13 22:52:54.944528",
    "failed_when_result": false,
    "invocation": {
        "module_args": {
            "_raw_params": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "non-zero return code",
    "rc": 5,
    "start": "2025-08-13 22:52:54.932531",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.002012",
    "stdout_lines": [
        "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.002012"
    ],
    "website_item": {
        "ansible_check_mode": false,
        "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
        "ansible_diff_mode": false,
        "ansible_facts": {},
        "ansible_forks": 5,
        "ansible_inventory_sources": [
            "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
        ],
        "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
        "ansible_run_tags": [
            "all"
        ],
        "ansible_skip_tags": [],
        "ansible_verbosity": 3,
        "ansible_version": {
            "full": "2.18.7",
            "major": 2,
            "minor": 18,
            "revision": 7,
            "string": "2.18.7"
        },
        "expected_status": 200,
        "group_names": [
            "test_websites"
        ],
        "groups": {
            "all": [
                "proxy1",
                "proxy2",
                "proxy3",
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "proxy_servers": [
                "proxy1",
                "proxy2",
                "proxy3"
            ],
            "test_websites": [
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "ungrouped": []
        },
        "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
        "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
        "inventory_hostname": "httpbin",
        "inventory_hostname_short": "httpbin",
        "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
        "request_timeout": 5,
        "test_url": "https://httpbin.org/status/200"
    }
}
2025-08-13 22:52:54,973 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:54,974 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 22:52:54,974 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:43
2025-08-13 22:52:55,078 p=3840 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {
    "ansible_facts": {
        "failed_count": "1",
        "proxy_tests": [
            {
                "error_msg": "",
                "response_time": "1.15",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.google.com",
                "website": "google"
            }
        ],
        "successful_count": "0"
    },
    "ansible_loop_var": "item_index",
    "changed": false,
    "item_index": 0
}
2025-08-13 22:52:55,160 p=3840 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {
    "ansible_facts": {
        "failed_count": "2",
        "proxy_tests": [
            {
                "error_msg": "",
                "response_time": "1.15",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.google.com",
                "website": "google"
            },
            {
                "error_msg": "",
                "response_time": "1.17",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://github.com",
                "website": "github"
            }
        ],
        "successful_count": "0"
    },
    "ansible_loop_var": "item_index",
    "changed": false,
    "item_index": 1
}
2025-08-13 22:52:55,241 p=3840 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {
    "ansible_facts": {
        "failed_count": "3",
        "proxy_tests": [
            {
                "error_msg": "",
                "response_time": "1.15",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.google.com",
                "website": "google"
            },
            {
                "error_msg": "",
                "response_time": "1.17",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://github.com",
                "website": "github"
            },
            {
                "error_msg": "",
                "response_time": "1.18",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.baidu.com",
                "website": "baidu"
            }
        ],
        "successful_count": "0"
    },
    "ansible_loop_var": "item_index",
    "changed": false,
    "item_index": 2
}
2025-08-13 22:52:55,323 p=3840 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {
    "ansible_facts": {
        "failed_count": "4",
        "proxy_tests": [
            {
                "error_msg": "",
                "response_time": "1.15",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.google.com",
                "website": "google"
            },
            {
                "error_msg": "",
                "response_time": "1.17",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://github.com",
                "website": "github"
            },
            {
                "error_msg": "",
                "response_time": "1.18",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.baidu.com",
                "website": "baidu"
            },
            {
                "error_msg": "",
                "response_time": "2.01",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://httpbin.org/status/200",
                "website": "httpbin"
            }
        ],
        "successful_count": "0"
    },
    "ansible_loop_var": "item_index",
    "changed": false,
    "item_index": 3
}
2025-08-13 22:52:55,329 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:55,330 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 22:52:55,330 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:68
2025-08-13 22:52:55,350 p=3840 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {
    "ansible_loop_var": "item_index",
    "changed": false,
    "false_condition": "ansible_check_mode and website_test_result.results is not defined",
    "item_index": 0,
    "skip_reason": "Conditional result was False"
}
2025-08-13 22:52:55,352 p=3840 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {
    "ansible_loop_var": "item_index",
    "changed": false,
    "false_condition": "ansible_check_mode and website_test_result.results is not defined",
    "item_index": 1,
    "skip_reason": "Conditional result was False"
}
2025-08-13 22:52:55,355 p=3840 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {
    "ansible_loop_var": "item_index",
    "changed": false,
    "false_condition": "ansible_check_mode and website_test_result.results is not defined",
    "item_index": 2,
    "skip_reason": "Conditional result was False"
}
2025-08-13 22:52:55,357 p=3840 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {
    "ansible_loop_var": "item_index",
    "changed": false,
    "false_condition": "ansible_check_mode and website_test_result.results is not defined",
    "item_index": 3,
    "skip_reason": "Conditional result was False"
}
2025-08-13 22:52:55,359 p=3840 u=runner n=ansible INFO| skipping: [localhost] => {
    "changed": false,
    "msg": "All items skipped"
}
2025-08-13 22:52:55,363 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:55,364 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] ******************************************
2025-08-13 22:52:55,364 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:86
2025-08-13 22:52:55,381 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "proxy_success_rate": "0.0"
    },
    "changed": false
}
2025-08-13 22:52:55,386 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:55,387 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ****************************************
2025-08-13 22:52:55,387 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:90
2025-08-13 22:52:55,404 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "proxy_status": "UNHEALTHY"
    },
    "changed": false
}
2025-08-13 22:52:55,410 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:55,411 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 22:52:55,411 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:94
2025-08-13 22:52:55,429 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "proxy_test_results": {
            "proxy1": {
                "failed_tests": "4",
                "proxy_name": "proxy1",
                "proxy_url": "http://proxy1.example.com:8080",
                "status": "UNHEALTHY",
                "success_rate": "0.0",
                "successful_tests": "0",
                "test_details": [
                    {
                        "error_msg": "",
                        "response_time": "1.15",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://www.google.com",
                        "website": "google"
                    },
                    {
                        "error_msg": "",
                        "response_time": "1.17",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://github.com",
                        "website": "github"
                    },
                    {
                        "error_msg": "",
                        "response_time": "1.18",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://www.baidu.com",
                        "website": "baidu"
                    },
                    {
                        "error_msg": "",
                        "response_time": "2.01",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://httpbin.org/status/200",
                        "website": "httpbin"
                    }
                ],
                "timestamp": "2025-08-13T22:52:53Z",
                "total_tests": 4
            }
        }
    },
    "changed": false
}
2025-08-13 22:52:55,434 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:55,434 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 22:52:55,435 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:4
2025-08-13 22:52:55,446 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "failed_count": 0,
        "proxy_name": "proxy2",
        "proxy_tests": [],
        "successful_count": 0
    },
    "changed": false
}
2025-08-13 22:52:55,451 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:55,451 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 22:52:55,451 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:11
2025-08-13 22:52:55,474 p=3840 u=runner n=ansible INFO| <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: runner
2025-08-13 22:52:55,474 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:55,476 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125575.47675-4090-275774590122627 `" && echo ansible-tmp-1755125575.47675-4090-275774590122627="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125575.47675-4090-275774590122627 `" ) && sleep 0'
2025-08-13 22:52:55,483 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/command.py
2025-08-13 22:52:55,483 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpevbi3vlt TO /home/runner/.ansible/tmp/ansible-tmp-1755125575.47675-4090-275774590122627/AnsiballZ_command.py
2025-08-13 22:52:55,484 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125575.47675-4090-275774590122627/ /home/runner/.ansible/tmp/ansible-tmp-1755125575.47675-4090-275774590122627/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:55,487 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125575.47675-4090-275774590122627/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:55,645 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125575.47675-4090-275774590122627/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:55,651 p=3840 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {
    "ansible_loop_var": "website_item",
    "changed": true,
    "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n",
    "delta": "0:00:00.010877",
    "end": "2025-08-13 22:52:55.631521",
    "failed_when_result": false,
    "invocation": {
        "module_args": {
            "_raw_params": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "non-zero return code",
    "rc": 5,
    "start": "2025-08-13 22:52:55.620644",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001172",
    "stdout_lines": [
        "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001172"
    ],
    "website_item": {
        "ansible_check_mode": false,
        "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
        "ansible_diff_mode": false,
        "ansible_facts": {},
        "ansible_forks": 5,
        "ansible_inventory_sources": [
            "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
        ],
        "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
        "ansible_run_tags": [
            "all"
        ],
        "ansible_skip_tags": [],
        "ansible_verbosity": 3,
        "ansible_version": {
            "full": "2.18.7",
            "major": 2,
            "minor": 18,
            "revision": 7,
            "string": "2.18.7"
        },
        "expected_status": 200,
        "group_names": [
            "test_websites"
        ],
        "groups": {
            "all": [
                "proxy1",
                "proxy2",
                "proxy3",
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "proxy_servers": [
                "proxy1",
                "proxy2",
                "proxy3"
            ],
            "test_websites": [
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "ungrouped": []
        },
        "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
        "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
        "inventory_hostname": "google",
        "inventory_hostname_short": "google",
        "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
        "request_timeout": 10,
        "test_url": "https://www.google.com"
    }
}
2025-08-13 22:52:55,657 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:55,660 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125575.6601205-4090-139477832573057 `" && echo ansible-tmp-1755125575.6601205-4090-139477832573057="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125575.6601205-4090-139477832573057 `" ) && sleep 0'
2025-08-13 22:52:55,666 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/command.py
2025-08-13 22:52:55,666 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpdtd27ax2 TO /home/runner/.ansible/tmp/ansible-tmp-1755125575.6601205-4090-139477832573057/AnsiballZ_command.py
2025-08-13 22:52:55,667 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125575.6601205-4090-139477832573057/ /home/runner/.ansible/tmp/ansible-tmp-1755125575.6601205-4090-139477832573057/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:55,670 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125575.6601205-4090-139477832573057/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:55,836 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125575.6601205-4090-139477832573057/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:55,842 p=3840 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {
    "ansible_loop_var": "website_item",
    "changed": true,
    "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n",
    "delta": "0:00:00.012623",
    "end": "2025-08-13 22:52:55.815357",
    "failed_when_result": false,
    "invocation": {
        "module_args": {
            "_raw_params": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "non-zero return code",
    "rc": 5,
    "start": "2025-08-13 22:52:55.802734",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.003277",
    "stdout_lines": [
        "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.003277"
    ],
    "website_item": {
        "ansible_check_mode": false,
        "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
        "ansible_diff_mode": false,
        "ansible_facts": {},
        "ansible_forks": 5,
        "ansible_inventory_sources": [
            "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
        ],
        "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
        "ansible_run_tags": [
            "all"
        ],
        "ansible_skip_tags": [],
        "ansible_verbosity": 3,
        "ansible_version": {
            "full": "2.18.7",
            "major": 2,
            "minor": 18,
            "revision": 7,
            "string": "2.18.7"
        },
        "expected_status": 200,
        "group_names": [
            "test_websites"
        ],
        "groups": {
            "all": [
                "proxy1",
                "proxy2",
                "proxy3",
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "proxy_servers": [
                "proxy1",
                "proxy2",
                "proxy3"
            ],
            "test_websites": [
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "ungrouped": []
        },
        "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
        "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
        "inventory_hostname": "github",
        "inventory_hostname_short": "github",
        "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
        "request_timeout": 15,
        "test_url": "https://github.com"
    }
}
2025-08-13 22:52:55,848 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:55,851 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125575.8510926-4090-245457671353667 `" && echo ansible-tmp-1755125575.8510926-4090-245457671353667="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125575.8510926-4090-245457671353667 `" ) && sleep 0'
2025-08-13 22:52:55,857 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/command.py
2025-08-13 22:52:55,857 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpz7dmky4y TO /home/runner/.ansible/tmp/ansible-tmp-1755125575.8510926-4090-245457671353667/AnsiballZ_command.py
2025-08-13 22:52:55,857 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125575.8510926-4090-245457671353667/ /home/runner/.ansible/tmp/ansible-tmp-1755125575.8510926-4090-245457671353667/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:55,861 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125575.8510926-4090-245457671353667/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:56,017 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125575.8510926-4090-245457671353667/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:56,022 p=3840 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {
    "ansible_loop_var": "website_item",
    "changed": true,
    "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n",
    "delta": "0:00:00.010746",
    "end": "2025-08-13 22:52:56.002539",
    "failed_when_result": false,
    "invocation": {
        "module_args": {
            "_raw_params": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "non-zero return code",
    "rc": 5,
    "start": "2025-08-13 22:52:55.991793",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001164",
    "stdout_lines": [
        "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001164"
    ],
    "website_item": {
        "ansible_check_mode": false,
        "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
        "ansible_diff_mode": false,
        "ansible_facts": {},
        "ansible_forks": 5,
        "ansible_inventory_sources": [
            "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
        ],
        "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
        "ansible_run_tags": [
            "all"
        ],
        "ansible_skip_tags": [],
        "ansible_verbosity": 3,
        "ansible_version": {
            "full": "2.18.7",
            "major": 2,
            "minor": 18,
            "revision": 7,
            "string": "2.18.7"
        },
        "expected_status": 200,
        "group_names": [
            "test_websites"
        ],
        "groups": {
            "all": [
                "proxy1",
                "proxy2",
                "proxy3",
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "proxy_servers": [
                "proxy1",
                "proxy2",
                "proxy3"
            ],
            "test_websites": [
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "ungrouped": []
        },
        "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
        "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
        "inventory_hostname": "baidu",
        "inventory_hostname_short": "baidu",
        "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
        "request_timeout": 10,
        "test_url": "https://www.baidu.com"
    }
}
2025-08-13 22:52:56,028 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:56,031 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125576.0313234-4090-104258439411286 `" && echo ansible-tmp-1755125576.0313234-4090-104258439411286="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125576.0313234-4090-104258439411286 `" ) && sleep 0'
2025-08-13 22:52:56,037 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/command.py
2025-08-13 22:52:56,037 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmph8h73k6m TO /home/runner/.ansible/tmp/ansible-tmp-1755125576.0313234-4090-104258439411286/AnsiballZ_command.py
2025-08-13 22:52:56,038 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125576.0313234-4090-104258439411286/ /home/runner/.ansible/tmp/ansible-tmp-1755125576.0313234-4090-104258439411286/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:56,041 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125576.0313234-4090-104258439411286/AnsiballZ_command.py && sleep 0'
2025-08-13 22:52:56,197 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125576.0313234-4090-104258439411286/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:56,203 p=3840 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {
    "ansible_loop_var": "website_item",
    "changed": true,
    "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n",
    "delta": "0:00:00.010573",
    "end": "2025-08-13 22:52:56.183460",
    "failed_when_result": false,
    "invocation": {
        "module_args": {
            "_raw_params": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n",
            "_uses_shell": true,
            "argv": null,
            "chdir": null,
            "creates": null,
            "executable": null,
            "expand_argument_vars": true,
            "removes": null,
            "stdin": null,
            "stdin_add_newline": true,
            "strip_empty_ends": true
        }
    },
    "msg": "non-zero return code",
    "rc": 5,
    "start": "2025-08-13 22:52:56.172887",
    "stderr": "",
    "stderr_lines": [],
    "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001181",
    "stdout_lines": [
        "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001181"
    ],
    "website_item": {
        "ansible_check_mode": false,
        "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg",
        "ansible_diff_mode": false,
        "ansible_facts": {},
        "ansible_forks": 5,
        "ansible_inventory_sources": [
            "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"
        ],
        "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python",
        "ansible_run_tags": [
            "all"
        ],
        "ansible_skip_tags": [],
        "ansible_verbosity": 3,
        "ansible_version": {
            "full": "2.18.7",
            "major": 2,
            "minor": 18,
            "revision": 7,
            "string": "2.18.7"
        },
        "expected_status": 200,
        "group_names": [
            "test_websites"
        ],
        "groups": {
            "all": [
                "proxy1",
                "proxy2",
                "proxy3",
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "proxy_servers": [
                "proxy1",
                "proxy2",
                "proxy3"
            ],
            "test_websites": [
                "google",
                "github",
                "baidu",
                "httpbin"
            ],
            "ungrouped": []
        },
        "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory",
        "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml",
        "inventory_hostname": "httpbin",
        "inventory_hostname_short": "httpbin",
        "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks",
        "request_timeout": 5,
        "test_url": "https://httpbin.org/status/200"
    }
}
2025-08-13 22:52:56,209 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:56,209 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 22:52:56,210 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:43
2025-08-13 22:52:56,310 p=3840 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {
    "ansible_facts": {
        "failed_count": "1",
        "proxy_tests": [
            {
                "error_msg": "",
                "response_time": "1.17",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.google.com",
                "website": "google"
            }
        ],
        "successful_count": "0"
    },
    "ansible_loop_var": "item_index",
    "changed": false,
    "item_index": 0
}
2025-08-13 22:52:56,391 p=3840 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {
    "ansible_facts": {
        "failed_count": "2",
        "proxy_tests": [
            {
                "error_msg": "",
                "response_time": "1.17",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.google.com",
                "website": "google"
            },
            {
                "error_msg": "",
                "response_time": "3.28",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://github.com",
                "website": "github"
            }
        ],
        "successful_count": "0"
    },
    "ansible_loop_var": "item_index",
    "changed": false,
    "item_index": 1
}
2025-08-13 22:52:56,477 p=3840 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {
    "ansible_facts": {
        "failed_count": "3",
        "proxy_tests": [
            {
                "error_msg": "",
                "response_time": "1.17",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.google.com",
                "website": "google"
            },
            {
                "error_msg": "",
                "response_time": "3.28",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://github.com",
                "website": "github"
            },
            {
                "error_msg": "",
                "response_time": "1.16",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.baidu.com",
                "website": "baidu"
            }
        ],
        "successful_count": "0"
    },
    "ansible_loop_var": "item_index",
    "changed": false,
    "item_index": 2
}
2025-08-13 22:52:56,559 p=3840 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {
    "ansible_facts": {
        "failed_count": "4",
        "proxy_tests": [
            {
                "error_msg": "",
                "response_time": "1.17",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.google.com",
                "website": "google"
            },
            {
                "error_msg": "",
                "response_time": "3.28",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://github.com",
                "website": "github"
            },
            {
                "error_msg": "",
                "response_time": "1.16",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://www.baidu.com",
                "website": "baidu"
            },
            {
                "error_msg": "",
                "response_time": "1.18",
                "status": "FAILED",
                "status_code": "-1",
                "timestamp": "2025-08-13T22:52:53Z",
                "url": "https://httpbin.org/status/200",
                "website": "httpbin"
            }
        ],
        "successful_count": "0"
    },
    "ansible_loop_var": "item_index",
    "changed": false,
    "item_index": 3
}
2025-08-13 22:52:56,565 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:56,566 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 22:52:56,566 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:68
2025-08-13 22:52:56,586 p=3840 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {
    "ansible_loop_var": "item_index",
    "changed": false,
    "false_condition": "ansible_check_mode and website_test_result.results is not defined",
    "item_index": 0,
    "skip_reason": "Conditional result was False"
}
2025-08-13 22:52:56,588 p=3840 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {
    "ansible_loop_var": "item_index",
    "changed": false,
    "false_condition": "ansible_check_mode and website_test_result.results is not defined",
    "item_index": 1,
    "skip_reason": "Conditional result was False"
}
2025-08-13 22:52:56,590 p=3840 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {
    "ansible_loop_var": "item_index",
    "changed": false,
    "false_condition": "ansible_check_mode and website_test_result.results is not defined",
    "item_index": 2,
    "skip_reason": "Conditional result was False"
}
2025-08-13 22:52:56,593 p=3840 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {
    "ansible_loop_var": "item_index",
    "changed": false,
    "false_condition": "ansible_check_mode and website_test_result.results is not defined",
    "item_index": 3,
    "skip_reason": "Conditional result was False"
}
2025-08-13 22:52:56,593 p=3840 u=runner n=ansible INFO| skipping: [localhost] => {
    "changed": false,
    "msg": "All items skipped"
}
2025-08-13 22:52:56,598 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:56,599 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] ******************************************
2025-08-13 22:52:56,599 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:86
2025-08-13 22:52:56,616 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "proxy_success_rate": "0.0"
    },
    "changed": false
}
2025-08-13 22:52:56,621 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:56,621 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ****************************************
2025-08-13 22:52:56,621 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:90
2025-08-13 22:52:56,637 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "proxy_status": "UNHEALTHY"
    },
    "changed": false
}
2025-08-13 22:52:56,642 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:56,642 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 22:52:56,642 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml:94
2025-08-13 22:52:56,661 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "proxy_test_results": {
            "proxy1": {
                "failed_tests": "4",
                "proxy_name": "proxy1",
                "proxy_url": "http://proxy1.example.com:8080",
                "status": "UNHEALTHY",
                "success_rate": "0.0",
                "successful_tests": "0",
                "test_details": [
                    {
                        "error_msg": "",
                        "response_time": "1.15",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://www.google.com",
                        "website": "google"
                    },
                    {
                        "error_msg": "",
                        "response_time": "1.17",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://github.com",
                        "website": "github"
                    },
                    {
                        "error_msg": "",
                        "response_time": "1.18",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://www.baidu.com",
                        "website": "baidu"
                    },
                    {
                        "error_msg": "",
                        "response_time": "2.01",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://httpbin.org/status/200",
                        "website": "httpbin"
                    }
                ],
                "timestamp": "2025-08-13T22:52:53Z",
                "total_tests": 4
            },
            "proxy2": {
                "failed_tests": "4",
                "proxy_name": "proxy2",
                "proxy_url": "http://proxy2.example.com:8080",
                "status": "UNHEALTHY",
                "success_rate": "0.0",
                "successful_tests": "0",
                "test_details": [
                    {
                        "error_msg": "",
                        "response_time": "1.17",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://www.google.com",
                        "website": "google"
                    },
                    {
                        "error_msg": "",
                        "response_time": "3.28",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://github.com",
                        "website": "github"
                    },
                    {
                        "error_msg": "",
                        "response_time": "1.16",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://www.baidu.com",
                        "website": "baidu"
                    },
                    {
                        "error_msg": "",
                        "response_time": "1.18",
                        "status": "FAILED",
                        "status_code": "-1",
                        "timestamp": "2025-08-13T22:52:53Z",
                        "url": "https://httpbin.org/status/200",
                        "website": "httpbin"
                    }
                ],
                "timestamp": "2025-08-13T22:52:53Z",
                "total_tests": 4
            }
        }
    },
    "changed": false
}
2025-08-13 22:52:56,666 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:56,666 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ********************************************
2025-08-13 22:52:56,666 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/main.yml:24
2025-08-13 22:52:56,676 p=3840 u=runner n=ansible INFO| <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: runner
2025-08-13 22:52:56,676 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:56,679 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210 `" && echo ansible-tmp-1755125576.6795285-4200-61109810455210="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210 `" ) && sleep 0'
2025-08-13 22:52:56,803 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/stat.py
2025-08-13 22:52:56,803 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpcd39or_n TO /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/AnsiballZ_stat.py
2025-08-13 22:52:56,803 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/ /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/AnsiballZ_stat.py && sleep 0'
2025-08-13 22:52:56,807 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/AnsiballZ_stat.py && sleep 0'
2025-08-13 22:52:57,073 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpsivkphpw/log-format.j2 TO /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/.source.log
2025-08-13 22:52:57,074 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/ /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/.source.log && sleep 0'
2025-08-13 22:52:57,156 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/copy.py
2025-08-13 22:52:57,156 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmp8c2tgpau TO /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/AnsiballZ_copy.py
2025-08-13 22:52:57,156 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/ /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/AnsiballZ_copy.py && sleep 0'
2025-08-13 22:52:57,160 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/AnsiballZ_copy.py && sleep 0'
2025-08-13 22:52:57,317 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:57,323 p=3840 u=runner n=ansible INFO| changed: [localhost] => {
    "changed": true,
    "checksum": "469a9aae0d51b7e2d3d1122fa9bf5fd02e7324c5",
    "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log",
    "diff": [],
    "gid": 118,
    "group": "docker",
    "invocation": {
        "module_args": {
            "_original_basename": "log-format.j2",
            "attributes": null,
            "backup": false,
            "checksum": "469a9aae0d51b7e2d3d1122fa9bf5fd02e7324c5",
            "content": null,
            "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log",
            "directory_mode": null,
            "follow": false,
            "force": true,
            "group": null,
            "local_follow": null,
            "mode": "0644",
            "owner": null,
            "remote_src": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": "/home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/.source.log",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "md5sum": "330557631d36777aee68336416c771d1",
    "mode": "0644",
    "owner": "runner",
    "size": 1936,
    "src": "/home/runner/.ansible/tmp/ansible-tmp-1755125576.6795285-4200-61109810455210/.source.log",
    "state": "file",
    "uid": 1001
}
2025-08-13 22:52:57,330 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,330 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ****************************************
2025-08-13 22:52:57,330 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/main.yml:33
2025-08-13 22:52:57,360 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "failed_proxies": [],
        "monitoring_results": [
            {
                "proxy1": {
                    "failed_tests": "4",
                    "proxy_name": "proxy1",
                    "proxy_url": "http://proxy1.example.com:8080",
                    "status": "UNHEALTHY",
                    "success_rate": "0.0",
                    "successful_tests": "0",
                    "test_details": [
                        {
                            "error_msg": "",
                            "response_time": "1.15",
                            "status": "FAILED",
                            "status_code": "-1",
                            "timestamp": "2025-08-13T22:52:53Z",
                            "url": "https://www.google.com",
                            "website": "google"
                        },
                        {
                            "error_msg": "",
                            "response_time": "1.17",
                            "status": "FAILED",
                            "status_code": "-1",
                            "timestamp": "2025-08-13T22:52:53Z",
                            "url": "https://github.com",
                            "website": "github"
                        },
                        {
                            "error_msg": "",
                            "response_time": "1.18",
                            "status": "FAILED",
                            "status_code": "-1",
                            "timestamp": "2025-08-13T22:52:53Z",
                            "url": "https://www.baidu.com",
                            "website": "baidu"
                        },
                        {
                            "error_msg": "",
                            "response_time": "2.01",
                            "status": "FAILED",
                            "status_code": "-1",
                            "timestamp": "2025-08-13T22:52:53Z",
                            "url": "https://httpbin.org/status/200",
                            "website": "httpbin"
                        }
                    ],
                    "timestamp": "2025-08-13T22:52:53Z",
                    "total_tests": 4
                },
                "proxy2": {
                    "failed_tests": "4",
                    "proxy_name": "proxy2",
                    "proxy_url": "http://proxy2.example.com:8080",
                    "status": "UNHEALTHY",
                    "success_rate": "0.0",
                    "successful_tests": "0",
                    "test_details": [
                        {
                            "error_msg": "",
                            "response_time": "1.17",
                            "status": "FAILED",
                            "status_code": "-1",
                            "timestamp": "2025-08-13T22:52:53Z",
                            "url": "https://www.google.com",
                            "website": "google"
                        },
                        {
                            "error_msg": "",
                            "response_time": "3.28",
                            "status": "FAILED",
                            "status_code": "-1",
                            "timestamp": "2025-08-13T22:52:53Z",
                            "url": "https://github.com",
                            "website": "github"
                        },
                        {
                            "error_msg": "",
                            "response_time": "1.16",
                            "status": "FAILED",
                            "status_code": "-1",
                            "timestamp": "2025-08-13T22:52:53Z",
                            "url": "https://www.baidu.com",
                            "website": "baidu"
                        },
                        {
                            "error_msg": "",
                            "response_time": "1.18",
                            "status": "FAILED",
                            "status_code": "-1",
                            "timestamp": "2025-08-13T22:52:53Z",
                            "url": "https://httpbin.org/status/200",
                            "website": "httpbin"
                        }
                    ],
                    "timestamp": "2025-08-13T22:52:53Z",
                    "total_tests": 4
                }
            }
        ],
        "successful_tests": "NotImplemented",
        "total_tests": "8"
    },
    "changed": false
}
2025-08-13 22:52:57,366 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,370 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,370 p=3840 u=runner n=ansible INFO| TASK [计算总体统计信息] ********************************************************
2025-08-13 22:52:57,370 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/playbooks/monitor-proxies.yml:29
2025-08-13 22:52:57,389 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "ansible_facts": {
        "overall_success_rate": "0.0",
        "total_failed_proxies": "0"
    },
    "changed": false
}
2025-08-13 22:52:57,394 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,394 p=3840 u=runner n=ansible INFO| TASK [显示监控汇总] ************************************************************
2025-08-13 22:52:57,394 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/playbooks/monitor-proxies.yml:34
2025-08-13 22:52:57,407 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T22:52:53Z",
        "总测试次数: 8",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 22:52:57,413 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,413 p=3840 u=runner n=ansible INFO| TASK [发送告警邮件] ************************************************************
2025-08-13 22:52:57,413 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/playbooks/monitor-proxies.yml:43
2025-08-13 22:52:57,436 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,439 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,440 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,443 p=3840 u=runner n=ansible INFO| redirecting (type: modules) ansible.builtin.mail to community.general.mail
2025-08-13 22:52:57,454 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,455 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,455 p=3840 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:52:57,461 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,462 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ****************************************
2025-08-13 22:52:57,462 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/send_alerts.yml:4
2025-08-13 22:52:57,472 p=3840 u=runner n=ansible INFO| <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: runner
2025-08-13 22:52:57,472 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:57,475 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795 `" && echo ansible-tmp-1755125577.475268-4243-194461593527795="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795 `" ) && sleep 0'
2025-08-13 22:52:57,504 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/stat.py
2025-08-13 22:52:57,504 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmppfvh7iab TO /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/AnsiballZ_stat.py
2025-08-13 22:52:57,505 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/ /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/AnsiballZ_stat.py && sleep 0'
2025-08-13 22:52:57,508 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/AnsiballZ_stat.py && sleep 0'
2025-08-13 22:52:57,669 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpi9w6c4_g/email-alert.html.j2 TO /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/.source.html
2025-08-13 22:52:57,669 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/ /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/.source.html && sleep 0'
2025-08-13 22:52:57,673 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible/modules/copy.py
2025-08-13 22:52:57,674 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmpuk39bnv0 TO /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/AnsiballZ_copy.py
2025-08-13 22:52:57,674 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/ /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/AnsiballZ_copy.py && sleep 0'
2025-08-13 22:52:57,677 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/AnsiballZ_copy.py && sleep 0'
2025-08-13 22:52:57,834 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:57,839 p=3840 u=runner n=ansible INFO| changed: [localhost] => {
    "changed": true,
    "checksum": "68ae9a326983d2f9aa371950ca6dd1dbb5a9fcd8",
    "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html",
    "diff": [],
    "gid": 118,
    "group": "docker",
    "invocation": {
        "module_args": {
            "_original_basename": "email-alert.html.j2",
            "attributes": null,
            "backup": false,
            "checksum": "68ae9a326983d2f9aa371950ca6dd1dbb5a9fcd8",
            "content": null,
            "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html",
            "directory_mode": null,
            "follow": false,
            "force": true,
            "group": null,
            "local_follow": null,
            "mode": "0644",
            "owner": null,
            "remote_src": null,
            "selevel": null,
            "serole": null,
            "setype": null,
            "seuser": null,
            "src": "/home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/.source.html",
            "unsafe_writes": false,
            "validate": null
        }
    },
    "md5sum": "c04b0ed4903f7904be55c35d95c1c30e",
    "mode": "0644",
    "owner": "runner",
    "size": 8363,
    "src": "/home/runner/.ansible/tmp/ansible-tmp-1755125577.475268-4243-194461593527795/.source.html",
    "state": "file",
    "uid": 1001
}
2025-08-13 22:52:57,844 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:57,845 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ********************************************
2025-08-13 22:52:57,845 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/send_alerts.yml:13
2025-08-13 22:52:57,862 p=3840 u=runner n=ansible INFO| redirecting (type: modules) ansible.builtin.mail to community.general.mail
2025-08-13 22:52:57,863 p=3840 u=runner n=ansible INFO| <127.0.0.1> ESTABLISH LOCAL CONNECTION FOR USER: runner
2025-08-13 22:52:57,864 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'echo ~runner && sleep 0'
2025-08-13 22:52:57,867 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '( umask 77 && mkdir -p "` echo /home/runner/.ansible/tmp `"&& mkdir "` echo /home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515 `" && echo ansible-tmp-1755125577.8668838-4283-174917061022515="` echo /home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515 `" ) && sleep 0'
2025-08-13 22:52:57,872 p=3840 u=runner n=ansible INFO| redirecting (type: modules) ansible.builtin.mail to community.general.mail
2025-08-13 22:52:57,947 p=3840 u=runner n=ansible INFO| Using module file /opt/pipx/venvs/ansible-core/lib/python3.12/site-packages/ansible_collections/community/general/plugins/modules/mail.py
2025-08-13 22:52:57,948 p=3840 u=runner n=ansible INFO| <127.0.0.1> PUT /home/runner/.ansible/tmp/ansible-local-3840jff4on96/tmp9d8kxcsf TO /home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/AnsiballZ_mail.py
2025-08-13 22:52:57,948 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'chmod u+rwx /home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/ /home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/AnsiballZ_mail.py && sleep 0'
2025-08-13 22:52:57,952 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c '/opt/pipx/venvs/ansible-core/bin/python /home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/AnsiballZ_mail.py && sleep 0'
2025-08-13 22:52:58,121 p=3840 u=runner n=ansible INFO| <127.0.0.1> EXEC /bin/sh -c 'rm -f -r /home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/ > /dev/null 2>&1 && sleep 0'
2025-08-13 22:52:58,126 p=3840 u=runner n=ansible INFO| The full traceback is:
Traceback (most recent call last):
  File "/home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/AnsiballZ_mail.py", line 107, in <module>
    _ansiballz_main()
  File "/home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/AnsiballZ_mail.py", line 99, in _ansiballz_main
    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)
  File "/home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/AnsiballZ_mail.py", line 47, in invoke_module
    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),
  File "<frozen runpy>", line 226, in run_module
  File "<frozen runpy>", line 98, in _run_module_code
  File "<frozen runpy>", line 88, in _run_code
  File "/tmp/ansible_mail_payload_sme08c8v/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py", line 428, in <module>
  File "/tmp/ansible_mail_payload_sme08c8v/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py", line 307, in main
  File "/usr/lib/python3.12/smtplib.py", line 255, in __init__
    (code, msg) = self.connect(host, port)
                  ^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/smtplib.py", line 341, in connect
    self.sock = self._get_socket(host, port, self.timeout)
                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/smtplib.py", line 312, in _get_socket
    return socket.create_connection((host, port), timeout,
           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 828, in create_connection
    for res in getaddrinfo(host, port, 0, SOCK_STREAM):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
  File "/usr/lib/python3.12/socket.py", line 963, in getaddrinfo
    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):
               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^
socket.gaierror: [Errno -5] No address associated with hostname

2025-08-13 22:52:58,126 p=3840 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {
    "changed": false,
    "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125577.8668838-4283-174917061022515/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_sme08c8v/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_sme08c8v/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n",
    "module_stdout": "",
    "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error",
    "rc": 1
}
2025-08-13 22:52:58,126 p=3840 u=runner n=ansible INFO| ...ignoring
2025-08-13 22:52:58,132 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:58,132 p=3840 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ****************************************
2025-08-13 22:52:58,132 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/send_alerts.yml:28
2025-08-13 22:52:58,150 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 22:52:58,155 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:58,160 p=3840 u=runner n=ansible INFO| Read vars_file '../group_vars/all.yml'
2025-08-13 22:52:58,160 p=3840 u=runner n=ansible INFO| TASK [监控状态总结] ************************************************************
2025-08-13 22:52:58,160 p=3840 u=runner n=ansible INFO| task path: /home/runner/work/monitor-webhtml/monitor-webhtml/playbooks/monitor-proxies.yml:51
2025-08-13 22:52:58,170 p=3840 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 22:52:58,171 p=3840 u=runner n=ansible INFO| PLAY RECAP *********************************************************************
2025-08-13 22:52:58,171 p=3840 u=runner n=ansible INFO| localhost                  : ok=30   changed=4    unreachable=0    failed=0    skipped=2    rescued=0    ignored=1   
2025-08-13 22:55:06,994 p=4361 u=runner n=ansible INFO| Using /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg as config file
2025-08-13 22:55:07,145 p=4361 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 22:55:07,150 p=4361 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 22:55:08,044 p=4361 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:55:08,048 p=4361 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 22:55:08,324 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"changed": false, "gid": 118, "group": "docker", "mode": "0755", "owner": "runner", "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs", "size": 4096, "state": "directory", "uid": 1001}
2025-08-13 22:55:08,330 p=4361 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 22:55:08,339 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_proxies": [], "monitoring_results": [], "successful_tests": 0, "total_tests": 0}, "changed": false}
2025-08-13 22:55:08,345 p=4361 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 22:55:08,365 p=4361 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:55:08,370 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 22:55:08,396 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"enabled_proxies": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy1", "inventory_hostname_short": "proxy1", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass1", "proxy_url": "http://proxy1.example.com:8080", "proxy_username": "user1"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy2", "inventory_hostname_short": "proxy2", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass2", "proxy_url": "http://proxy2.example.com:8080", "proxy_username": "user2"}]}, "changed": false}
2025-08-13 22:55:08,401 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 22:55:08,423 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"test_websites": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}]}, "changed": false}
2025-08-13 22:55:08,428 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 22:55:08,440 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"current_timestamp": "2025-08-13T22:55:07Z", "proxy_test_results": {}}, "changed": false}
2025-08-13 22:55:08,445 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 22:55:08,470 p=4361 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 22:55:08,474 p=4361 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 22:55:08,479 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 22:55:08,490 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy1", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 22:55:08,495 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 22:55:08,513 p=4361 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy1 (http://proxy1.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 22:55:08,518 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 22:55:08,790 p=4361 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010272", "end": "2025-08-13 22:55:08.770138", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:55:08.759866", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001186", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001186"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 22:55:08,970 p=4361 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.010348", "end": "2025-08-13 22:55:08.949499", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:55:08.939151", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001172", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001172"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 22:55:09,152 p=4361 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.010994", "end": "2025-08-13 22:55:09.131684", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:55:09.120690", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001192", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001192"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 22:55:09,332 p=4361 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010526", "end": "2025-08-13 22:55:09.313022", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:55:09.302496", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001267", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001267"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 22:55:09,339 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 显示curl测试详细结果（调试用）] ******************************************************************
2025-08-13 22:55:09,367 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {
    "msg": [
        "网站 0: google",
        "curl返回码: 5",
        "curl输出: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001186",
        "curl错误: "
    ]
}
2025-08-13 22:55:09,375 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {
    "msg": [
        "网站 1: github",
        "curl返回码: 5",
        "curl输出: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001172",
        "curl错误: "
    ]
}
2025-08-13 22:55:09,384 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {
    "msg": [
        "网站 2: baidu",
        "curl返回码: 5",
        "curl输出: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001192",
        "curl错误: "
    ]
}
2025-08-13 22:55:09,392 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {
    "msg": [
        "网站 3: httpbin",
        "curl返回码: 5",
        "curl输出: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001267",
        "curl错误: "
    ]
}
2025-08-13 22:55:09,399 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 22:55:09,547 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 22:55:09,669 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 22:55:09,791 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 22:55:09,918 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 22:55:09,925 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 22:55:09,947 p=4361 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 22:55:09,948 p=4361 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 22:55:09,951 p=4361 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 22:55:09,953 p=4361 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 22:55:09,954 p=4361 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 22:55:09,961 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 22:55:09,979 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 22:55:09,985 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 22:55:10,002 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 22:55:10,008 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 22:55:10,027 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:55:07Z", "total_tests": 4}}}, "changed": false}
2025-08-13 22:55:10,032 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 22:55:10,043 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy2", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 22:55:10,048 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 22:55:10,066 p=4361 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy2 (http://proxy2.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 22:55:10,071 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 22:55:10,273 p=4361 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010786", "end": "2025-08-13 22:55:10.251559", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:55:10.240773", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001175", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001175"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 22:55:10,454 p=4361 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.010759", "end": "2025-08-13 22:55:10.434062", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:55:10.423303", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001167", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001167"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 22:55:10,651 p=4361 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.014753", "end": "2025-08-13 22:55:10.624519", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:55:10.609766", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001165", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001165"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 22:55:10,840 p=4361 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.011304", "end": "2025-08-13 22:55:10.820119", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 22:55:10.808815", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001161", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001161"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 22:55:10,848 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 显示curl测试详细结果（调试用）] ******************************************************************
2025-08-13 22:55:10,876 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {
    "msg": [
        "网站 0: google",
        "curl返回码: 5",
        "curl输出: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001175",
        "curl错误: "
    ]
}
2025-08-13 22:55:10,883 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {
    "msg": [
        "网站 1: github",
        "curl返回码: 5",
        "curl输出: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001167",
        "curl错误: "
    ]
}
2025-08-13 22:55:10,892 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {
    "msg": [
        "网站 2: baidu",
        "curl返回码: 5",
        "curl输出: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001165",
        "curl错误: "
    ]
}
2025-08-13 22:55:10,900 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {
    "msg": [
        "网站 3: httpbin",
        "curl返回码: 5",
        "curl输出: CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001161",
        "curl错误: "
    ]
}
2025-08-13 22:55:10,907 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 22:55:11,053 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 22:55:11,178 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 22:55:11,304 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 22:55:11,427 p=4361 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 22:55:11,434 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 22:55:11,459 p=4361 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 22:55:11,461 p=4361 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 22:55:11,464 p=4361 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 22:55:11,466 p=4361 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 22:55:11,467 p=4361 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 22:55:11,473 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 22:55:11,495 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 22:55:11,503 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 22:55:11,521 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 22:55:11,527 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 22:55:11,546 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:55:07Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:55:07Z", "total_tests": 4}}}, "changed": false}
2025-08-13 22:55:11,552 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 22:55:12,094 p=4361 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "b052a022eb8904900138a630fd34d1cf30b80163", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log", "gid": 118, "group": "docker", "md5sum": "6f24daee7fe94d69c5015cd4d7a5419c", "mode": "0644", "owner": "runner", "size": 2312, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755125711.5659468-4725-48548100630935/.source.log", "state": "file", "uid": 1001}
2025-08-13 22:55:12,101 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 22:55:12,130 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_proxies": [], "monitoring_results": [{"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:55:07Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T22:55:07Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T22:55:07Z", "total_tests": 4}}], "successful_tests": "NotImplemented", "total_tests": "8"}, "changed": false}
2025-08-13 22:55:12,139 p=4361 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 22:55:12,158 p=4361 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"overall_success_rate": "0.0", "total_failed_proxies": "0"}, "changed": false}
2025-08-13 22:55:12,163 p=4361 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 22:55:12,177 p=4361 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T22:55:07Z",
        "总测试次数: 8",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 22:55:12,182 p=4361 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 22:55:12,223 p=4361 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:55:12,230 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 22:55:12,606 p=4361 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "a9c7eacee4bfda22f712fb7a371b1406cba4f4e2", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html", "gid": 118, "group": "docker", "md5sum": "64bcc0c323ca0455fdb1985df29968a8", "mode": "0644", "owner": "runner", "size": 8347, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755125712.2424352-4768-61532847713032/.source.html", "state": "file", "uid": 1001}
2025-08-13 22:55:12,612 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 22:55:12,901 p=4361 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 22:55:12,901 p=4361 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125712.6344023-4807-161553759525393/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125712.6344023-4807-161553759525393/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125712.6344023-4807-161553759525393/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_o6_lrbhh/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_o6_lrbhh/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 22:55:12,901 p=4361 u=runner n=ansible INFO| ...ignoring
2025-08-13 22:55:12,908 p=4361 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 22:55:12,926 p=4361 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 22:55:12,936 p=4361 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 22:55:12,947 p=4361 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 22:55:12,948 p=4361 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 22:55:12,948 p=4361 u=runner n=ansible INFO| localhost                  : ok=34   changed=4    unreachable=0    failed=0    skipped=2    rescued=0    ignored=1   
2025-08-13 22:57:24,234 p=4861 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 22:57:24,240 p=4861 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 22:57:25,131 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:25,136 p=4861 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 22:57:25,400 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:25,405 p=4861 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 22:57:25,413 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:25,418 p=4861 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 22:57:25,438 p=4861 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:57:25,443 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 22:57:25,466 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:25,471 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 22:57:25,492 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:25,498 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 22:57:25,508 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:25,514 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 22:57:25,540 p=4861 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 22:57:25,544 p=4861 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 22:57:25,550 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 22:57:25,561 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:25,567 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 22:57:25,585 p=4861 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy1 (http://proxy1.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 22:57:25,591 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 22:57:25,868 p=4861 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 22:57:26,052 p=4861 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 22:57:26,229 p=4861 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 22:57:26,414 p=4861 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 22:57:26,421 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 22:57:26,568 p=4861 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 22:57:26,694 p=4861 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 22:57:26,820 p=4861 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 22:57:26,944 p=4861 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 22:57:26,950 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 22:57:26,970 p=4861 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 22:57:26,972 p=4861 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 22:57:26,975 p=4861 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 22:57:26,977 p=4861 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 22:57:26,978 p=4861 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 22:57:26,984 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 22:57:27,002 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:27,008 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 22:57:27,026 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:27,034 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 22:57:27,053 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:27,059 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 22:57:27,070 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:27,075 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 22:57:27,093 p=4861 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy2 (http://proxy2.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 22:57:27,098 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 22:57:27,305 p=4861 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 22:57:27,490 p=4861 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 22:57:27,676 p=4861 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 22:57:27,859 p=4861 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 22:57:27,866 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 22:57:28,010 p=4861 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 22:57:28,138 p=4861 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 22:57:28,261 p=4861 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 22:57:28,387 p=4861 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 22:57:28,393 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 22:57:28,415 p=4861 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 22:57:28,417 p=4861 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 22:57:28,420 p=4861 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 22:57:28,423 p=4861 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 22:57:28,423 p=4861 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 22:57:28,429 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 22:57:28,448 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:28,453 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 22:57:28,470 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:28,476 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 22:57:28,497 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:28,503 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 22:57:29,061 p=4861 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 22:57:29,067 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 22:57:29,098 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:29,110 p=4861 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 22:57:29,128 p=4861 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:57:29,133 p=4861 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 22:57:29,146 p=4861 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T22:57:24Z",
        "总测试次数: 8",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 22:57:29,151 p=4861 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 22:57:29,194 p=4861 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:57:29,200 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 22:57:29,570 p=4861 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 22:57:29,576 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 22:57:29,862 p=4861 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 22:57:29,863 p=4861 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125849.598137-5304-81813526447076/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125849.598137-5304-81813526447076/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125849.598137-5304-81813526447076/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_3tcrgqbb/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_3tcrgqbb/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 22:57:29,863 p=4861 u=runner n=ansible INFO| ...ignoring
2025-08-13 22:57:29,869 p=4861 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 22:57:29,890 p=4861 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 22:57:29,900 p=4861 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 22:57:29,912 p=4861 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 22:57:29,913 p=4861 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 22:57:29,913 p=4861 u=runner n=ansible INFO| localhost                  : ok=32   changed=4    unreachable=0    failed=0    skipped=2    rescued=0    ignored=1   
2025-08-13 22:59:02,535 p=5346 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 22:59:02,542 p=5346 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 22:59:03,450 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:03,455 p=5346 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 22:59:03,731 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:03,736 p=5346 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 22:59:03,744 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:03,749 p=5346 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 22:59:03,769 p=5346 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:59:03,774 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 22:59:03,800 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:03,806 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 22:59:03,828 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:03,834 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 22:59:03,844 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:03,850 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 22:59:03,875 p=5346 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 22:59:03,880 p=5346 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 22:59:03,884 p=5346 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=direct_test)
2025-08-13 22:59:03,890 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 22:59:03,901 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:03,907 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 22:59:03,924 p=5346 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy1 (http://proxy1.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 22:59:03,930 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 22:59:04,197 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 22:59:04,383 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 22:59:04,584 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 22:59:04,785 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 22:59:04,793 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 22:59:04,939 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 22:59:05,062 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 22:59:05,184 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 22:59:05,309 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 22:59:05,315 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 22:59:05,337 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 22:59:05,339 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 22:59:05,341 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 22:59:05,344 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 22:59:05,345 p=5346 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 22:59:05,352 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 22:59:05,371 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:05,377 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 22:59:05,394 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:05,400 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 22:59:05,419 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:05,425 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 22:59:05,436 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:05,441 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 22:59:05,460 p=5346 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy2 (http://proxy2.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 22:59:05,465 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 22:59:05,679 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 22:59:05,866 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 22:59:06,046 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 22:59:06,227 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 22:59:06,235 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 22:59:06,381 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 22:59:06,504 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 22:59:06,628 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 22:59:06,756 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 22:59:06,763 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 22:59:06,785 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 22:59:06,787 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 22:59:06,790 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 22:59:06,793 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 22:59:06,794 p=5346 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 22:59:06,799 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 22:59:06,818 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:06,824 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 22:59:06,841 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:06,847 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 22:59:06,871 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:06,879 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 22:59:06,890 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:06,896 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 22:59:06,914 p=5346 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: direct_test ()",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 22:59:06,919 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 22:59:07,125 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 22:59:07,485 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 22:59:07,674 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 22:59:07,860 p=5346 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 22:59:07,867 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 22:59:08,017 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 22:59:08,147 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 22:59:08,272 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 22:59:08,399 p=5346 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 22:59:08,406 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 22:59:08,429 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 22:59:08,431 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 22:59:08,434 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 22:59:08,436 p=5346 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 22:59:08,437 p=5346 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 22:59:08,443 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 22:59:08,463 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:08,470 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 22:59:08,487 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:08,493 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 22:59:08,515 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:08,521 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 22:59:09,095 p=5346 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 22:59:09,101 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 22:59:09,134 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:09,146 p=5346 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 22:59:09,165 p=5346 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 22:59:09,170 p=5346 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 22:59:09,183 p=5346 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T22:59:03Z",
        "总测试次数: 12",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 22:59:09,189 p=5346 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 22:59:09,230 p=5346 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 22:59:09,236 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 22:59:09,617 p=5346 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 22:59:09,623 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 22:59:09,919 p=5346 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 22:59:09,919 p=5346 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125949.6457925-5902-28222791041985/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125949.6457925-5902-28222791041985/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755125949.6457925-5902-28222791041985/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_1d73dp76/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_1d73dp76/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 22:59:09,919 p=5346 u=runner n=ansible INFO| ...ignoring
2025-08-13 22:59:09,926 p=5346 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 22:59:09,944 p=5346 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 22:59:09,954 p=5346 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 22:59:09,965 p=5346 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 22:59:09,966 p=5346 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 22:59:09,967 p=5346 u=runner n=ansible INFO| localhost                  : ok=40   changed=5    unreachable=0    failed=0    skipped=3    rescued=0    ignored=1   
2025-08-13 23:00:05,280 p=5947 u=runner n=ansible INFO| Using /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg as config file
2025-08-13 23:00:05,439 p=5947 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ************************************************
2025-08-13 23:00:05,445 p=5947 u=runner n=ansible INFO| TASK [Gathering Facts] *********************************************************
2025-08-13 23:00:06,347 p=5947 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:00:06,352 p=5947 u=runner n=ansible INFO| TASK [创建日志目录] ************************************************************
2025-08-13 23:00:06,615 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"changed": false, "gid": 118, "group": "docker", "mode": "0755", "owner": "runner", "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs", "size": 4096, "state": "directory", "uid": 1001}
2025-08-13 23:00:06,622 p=5947 u=runner n=ansible INFO| TASK [初始化监控结果变量] ******************************************************
2025-08-13 23:00:06,630 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_proxies": [], "monitoring_results": [], "successful_tests": 0, "total_tests": 0}, "changed": false}
2025-08-13 23:00:06,635 p=5947 u=runner n=ansible INFO| TASK [执行代理监控任务] ********************************************************
2025-08-13 23:00:06,655 p=5947 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:00:06,661 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] ******************************
2025-08-13 23:00:06,687 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"enabled_proxies": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy1", "inventory_hostname_short": "proxy1", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass1", "proxy_url": "http://proxy1.example.com:8080", "proxy_username": "user1"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy2", "inventory_hostname_short": "proxy2", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass2", "proxy_url": "http://proxy2.example.com:8080", "proxy_username": "user2"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "direct_test", "inventory_hostname_short": "direct_test", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "", "proxy_url": "", "proxy_username": ""}]}, "changed": false}
2025-08-13 23:00:06,693 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ****************************************
2025-08-13 23:00:06,716 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"test_websites": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}]}, "changed": false}
2025-08-13 23:00:06,721 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] ******************************************
2025-08-13 23:00:06,732 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"current_timestamp": "2025-08-13T23:00:05Z", "proxy_test_results": {}}, "changed": false}
2025-08-13 23:00:06,738 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ****************************
2025-08-13 23:00:06,763 p=5947 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 23:00:06,768 p=5947 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 23:00:06,772 p=5947 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=direct_test)
2025-08-13 23:00:06,778 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 23:00:06,790 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy1", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:00:06,796 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ****************************************
2025-08-13 23:00:06,814 p=5947 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy1 (http://proxy1.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:00:06,820 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 23:00:07,103 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010692", "end": "2025-08-13 23:00:07.080644", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:00:07.069952", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001193", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001193"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:00:07,297 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.016136", "end": "2025-08-13 23:00:07.271375", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:00:07.255239", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.003212", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.003212"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:00:07,480 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.011376", "end": "2025-08-13 23:00:07.460232", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:00:07.448856", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001158", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001158"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:00:07,674 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010515", "end": "2025-08-13 23:00:07.654153", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:00:07.643638", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001174", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001174"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:00:07,682 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 23:00:07,827 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:00:07,951 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:00:08,077 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:00:08,201 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:00:08,208 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 23:00:08,232 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:08,234 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:08,237 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:08,240 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:08,241 p=5947 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:00:08,248 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] ******************************************
2025-08-13 23:00:08,267 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 23:00:08,273 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ****************************************
2025-08-13 23:00:08,289 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 23:00:08,294 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 23:00:08,313 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:00:05Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:00:08,319 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 23:00:08,330 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy2", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:00:08,336 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ****************************************
2025-08-13 23:00:08,353 p=5947 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy2 (http://proxy2.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:00:08,358 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 23:00:08,559 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010283", "end": "2025-08-13 23:00:08.538494", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:00:08.528211", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001443", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001443"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:00:08,742 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.010659", "end": "2025-08-13 23:00:08.721867", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:00:08.711208", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001141", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001141"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:00:08,923 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.010426", "end": "2025-08-13 23:00:08.903392", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:00:08.892966", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001173", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001173"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:00:09,104 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010684", "end": "2025-08-13 23:00:09.083932", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:00:09.073248", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001201", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001201"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:00:09,111 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 23:00:09,260 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:00:09,384 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:00:09,508 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:00:09,632 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:00:09,639 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 23:00:09,661 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:09,663 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:09,666 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:09,669 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:09,669 p=5947 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:00:09,675 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] ******************************************
2025-08-13 23:00:09,695 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 23:00:09,700 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ****************************************
2025-08-13 23:00:09,717 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 23:00:09,723 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 23:00:09,747 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:00:05Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:00:05Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:00:09,755 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 23:00:09,766 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "direct_test", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:00:09,771 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ****************************************
2025-08-13 23:00:09,788 p=5947 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: direct_test ()",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:00:09,793 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 23:00:10,000 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 直连测试（无代理）\ncurl -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.011784", "end": "2025-08-13 23:00:09.977544", "failed_when_result": false, "msg": "non-zero return code", "rc": 6, "start": "2025-08-13 23:00:09.965760", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001179", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001179"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:00:10,630 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 直连测试（无代理）\ncurl -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.454581", "end": "2025-08-13 23:00:10.609199", "failed_when_result": false, "msg": "", "rc": 0, "start": "2025-08-13 23:00:10.154618", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:200;CURL_TIME_TOTAL:0.444966", "stdout_lines": ["CURL_STATUS_CODE:200;CURL_TIME_TOTAL:0.444966"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:00:10,814 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 直连测试（无代理）\ncurl -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.011014", "end": "2025-08-13 23:00:10.792666", "failed_when_result": false, "msg": "non-zero return code", "rc": 6, "start": "2025-08-13 23:00:10.781652", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001191", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001191"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:00:10,999 p=5947 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 直连测试（无代理）\ncurl -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010591", "end": "2025-08-13 23:00:10.978162", "failed_when_result": false, "msg": "non-zero return code", "rc": 6, "start": "2025-08-13 23:00:10.967571", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001178", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001178"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:00:11,006 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 23:00:11,151 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:00:11,277 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:00:11,403 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:00:11,528 p=5947 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:00:11,536 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 23:00:11,558 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:11,560 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:11,563 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:11,566 p=5947 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:00:11,567 p=5947 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:00:11,573 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] ******************************************
2025-08-13 23:00:11,592 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 23:00:11,598 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ****************************************
2025-08-13 23:00:11,616 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 23:00:11,623 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 23:00:11,644 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"direct_test": {"failed_tests": "4", "proxy_name": "direct_test", "proxy_url": "", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:00:05Z", "total_tests": 4}, "proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:00:05Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:00:05Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:00:11,650 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ********************************************
2025-08-13 23:00:12,212 p=5947 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "4f5a450aaca00a1f22cc43cb8afbbdab164be8aa", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log", "gid": 118, "group": "docker", "md5sum": "be5239cf785cb3aa6ce393ce307c86db", "mode": "0644", "owner": "runner", "size": 3162, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755126011.6633055-6427-38722470490114/.source.log", "state": "file", "uid": 1001}
2025-08-13 23:00:12,218 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ****************************************
2025-08-13 23:00:12,250 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_proxies": [], "monitoring_results": [{"direct_test": {"failed_tests": "4", "proxy_name": "direct_test", "proxy_url": "", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:00:05Z", "total_tests": 4}, "proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:00:05Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.google.com", "website": "google"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://github.com", "website": "github"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://www.baidu.com", "website": "baidu"}, {"error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:00:05Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:00:05Z", "total_tests": 4}}], "successful_tests": "NotImplemented", "total_tests": "12"}, "changed": false}
2025-08-13 23:00:12,263 p=5947 u=runner n=ansible INFO| TASK [计算总体统计信息] ********************************************************
2025-08-13 23:00:12,281 p=5947 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"overall_success_rate": "0.0", "total_failed_proxies": "0"}, "changed": false}
2025-08-13 23:00:12,287 p=5947 u=runner n=ansible INFO| TASK [显示监控汇总] ************************************************************
2025-08-13 23:00:12,300 p=5947 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T23:00:05Z",
        "总测试次数: 12",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 23:00:12,305 p=5947 u=runner n=ansible INFO| TASK [发送告警邮件] ************************************************************
2025-08-13 23:00:12,347 p=5947 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:00:12,354 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ****************************************
2025-08-13 23:00:12,722 p=5947 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "2e4aa927539898a0bc4c0bb457bcbda72a6c56a7", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html", "gid": 118, "group": "docker", "md5sum": "871c2fc855775e0161bb535f940e90cb", "mode": "0644", "owner": "runner", "size": 12154, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755126012.367177-6470-159079913654410/.source.html", "state": "file", "uid": 1001}
2025-08-13 23:00:12,727 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ********************************************
2025-08-13 23:00:13,010 p=5947 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 23:00:13,011 p=5947 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126012.7483234-6509-3622440524345/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126012.7483234-6509-3622440524345/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126012.7483234-6509-3622440524345/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_0i4igg6p/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_0i4igg6p/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 23:00:13,011 p=5947 u=runner n=ansible INFO| ...ignoring
2025-08-13 23:00:13,017 p=5947 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ****************************************
2025-08-13 23:00:13,038 p=5947 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 23:00:13,048 p=5947 u=runner n=ansible INFO| TASK [监控状态总结] ************************************************************
2025-08-13 23:00:13,058 p=5947 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 23:00:13,059 p=5947 u=runner n=ansible INFO| PLAY RECAP *********************************************************************
2025-08-13 23:00:13,059 p=5947 u=runner n=ansible INFO| localhost                  : ok=40   changed=5    unreachable=0    failed=0    skipped=3    rescued=0    ignored=1   
2025-08-13 23:01:01,497 p=6540 u=runner n=ansible INFO| Using /home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg as config file
2025-08-13 23:01:01,654 p=6540 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ************************************************
2025-08-13 23:01:01,660 p=6540 u=runner n=ansible INFO| TASK [Gathering Facts] *********************************************************
2025-08-13 23:01:02,553 p=6540 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:01:02,557 p=6540 u=runner n=ansible INFO| TASK [创建日志目录] ************************************************************
2025-08-13 23:01:02,827 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"changed": false, "gid": 118, "group": "docker", "mode": "0755", "owner": "runner", "path": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs", "size": 4096, "state": "directory", "uid": 1001}
2025-08-13 23:01:02,834 p=6540 u=runner n=ansible INFO| TASK [初始化监控结果变量] ******************************************************
2025-08-13 23:01:02,842 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_proxies": [], "monitoring_results": [], "successful_tests": 0, "total_tests": 0}, "changed": false}
2025-08-13 23:01:02,847 p=6540 u=runner n=ansible INFO| TASK [执行代理监控任务] ********************************************************
2025-08-13 23:01:02,867 p=6540 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:01:02,872 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] ******************************
2025-08-13 23:01:02,899 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"enabled_proxies": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy1", "inventory_hostname_short": "proxy1", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass1", "proxy_url": "http://proxy1.example.com:8080", "proxy_username": "user1"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "proxy2", "inventory_hostname_short": "proxy2", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "pass2", "proxy_url": "http://proxy2.example.com:8080", "proxy_username": "user2"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_host": "localhost", "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "enabled": true, "group_names": ["proxy_servers"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "direct_test", "inventory_hostname_short": "direct_test", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "proxy_password": "", "proxy_url": "", "proxy_username": ""}]}, "changed": false}
2025-08-13 23:01:02,904 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ****************************************
2025-08-13 23:01:02,929 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"test_websites": [{"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}, {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}]}, "changed": false}
2025-08-13 23:01:02,934 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] ******************************************
2025-08-13 23:01:02,945 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"current_timestamp": "2025-08-13T23:01:02Z", "proxy_test_results": {}}, "changed": false}
2025-08-13 23:01:02,952 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ****************************
2025-08-13 23:01:02,979 p=6540 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 23:01:02,984 p=6540 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 23:01:02,988 p=6540 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=direct_test)
2025-08-13 23:01:02,994 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 23:01:03,005 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy1", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:01:03,011 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ****************************************
2025-08-13 23:01:03,033 p=6540 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy1 (http://proxy1.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:01:03,039 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 23:01:03,312 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010564", "end": "2025-08-13 23:01:03.290015", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:01:03.279451", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001167", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001167"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:01:03,498 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.011079", "end": "2025-08-13 23:01:03.477304", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:01:03.466225", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001186", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001186"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:01:03,686 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.010582", "end": "2025-08-13 23:01:03.665926", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:01:03.655344", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001142", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001142"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:01:03,879 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user1:pass1@proxy1.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010003", "end": "2025-08-13 23:01:03.858959", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:01:03.848956", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001153", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001153"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:01:03,886 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 23:01:04,078 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:01:04,248 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:01:04,423 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:01:04,597 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:01:04,606 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 23:01:04,627 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:04,629 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:04,631 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:04,634 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:04,634 p=6540 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:01:04,640 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] ******************************************
2025-08-13 23:01:04,659 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 23:01:04,665 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ****************************************
2025-08-13 23:01:04,683 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 23:01:04,689 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 23:01:04,709 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:01:02Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:01:04,715 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 23:01:04,726 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "proxy2", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:01:04,732 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ****************************************
2025-08-13 23:01:04,750 p=6540 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy2 (http://proxy2.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:01:04,755 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 23:01:04,959 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.010869", "end": "2025-08-13 23:01:04.938404", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:01:04.927535", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001176", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001176"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:01:05,143 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.011926", "end": "2025-08-13 23:01:05.121353", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:01:05.109427", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001177", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001177"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:01:05,328 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.011313", "end": "2025-08-13 23:01:05.307723", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:01:05.296410", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001667", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001667"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:01:05,513 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 使用带认证的代理\ncurl -x \"http://user2:pass2@proxy2.example.com:8080\"     -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.010998", "end": "2025-08-13 23:01:05.491334", "failed_when_result": false, "msg": "non-zero return code", "rc": 5, "start": "2025-08-13 23:01:05.480336", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001182", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001182"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:01:05,520 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 23:01:05,715 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:01:05,883 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:01:06,053 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:01:06,223 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:01:06,230 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 23:01:06,254 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:06,255 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:06,258 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:06,260 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:06,261 p=6540 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:01:06,267 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] ******************************************
2025-08-13 23:01:06,286 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 23:01:06,294 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ****************************************
2025-08-13 23:01:06,310 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 23:01:06,316 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 23:01:06,337 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:01:02Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:01:02Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:01:06,343 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] **************************************
2025-08-13 23:01:06,354 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_count": 0, "proxy_name": "direct_test", "proxy_tests": [], "successful_count": 0}, "changed": false}
2025-08-13 23:01:06,359 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ****************************************
2025-08-13 23:01:06,377 p=6540 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: direct_test ()",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:01:06,383 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ********************************
2025-08-13 23:01:06,587 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=google) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 直连测试（无代理）\ncurl -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.google.com\"\n", "delta": "0:00:00.011184", "end": "2025-08-13 23:01:06.564698", "failed_when_result": false, "msg": "non-zero return code", "rc": 6, "start": "2025-08-13 23:01:06.553514", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001170", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001170"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "google", "inventory_hostname_short": "google", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.google.com"}}
2025-08-13 23:01:07,220 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=github) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 直连测试（无代理）\ncurl -I -s     --connect-timeout 5     --max-time 15     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://github.com\"\n", "delta": "0:00:00.460267", "end": "2025-08-13 23:01:07.197699", "failed_when_result": false, "msg": "", "rc": 0, "start": "2025-08-13 23:01:06.737432", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:200;CURL_TIME_TOTAL:0.450772", "stdout_lines": ["CURL_STATUS_CODE:200;CURL_TIME_TOTAL:0.450772"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "github", "inventory_hostname_short": "github", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 15, "test_url": "https://github.com"}}
2025-08-13 23:01:07,408 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=baidu) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 直连测试（无代理）\ncurl -I -s     --connect-timeout 5     --max-time 10     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://www.baidu.com\"\n", "delta": "0:00:00.011564", "end": "2025-08-13 23:01:07.386439", "failed_when_result": false, "msg": "non-zero return code", "rc": 6, "start": "2025-08-13 23:01:07.374875", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001201", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001201"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "baidu", "inventory_hostname_short": "baidu", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 10, "test_url": "https://www.baidu.com"}}
2025-08-13 23:01:07,600 p=6540 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin) => {"ansible_loop_var": "website_item", "changed": true, "cmd": "# 直连测试（无代理）\ncurl -I -s     --connect-timeout 5     --max-time 5     -A \"Ansible-Proxy-Monitor/1.0\"     --insecure     -w \"CURL_STATUS_CODE:%{http_code};CURL_TIME_TOTAL:%{time_total}\\n\"     -o /dev/null     \"https://httpbin.org/status/200\"\n", "delta": "0:00:00.012057", "end": "2025-08-13 23:01:07.575734", "failed_when_result": false, "msg": "non-zero return code", "rc": 6, "start": "2025-08-13 23:01:07.563677", "stderr": "", "stderr_lines": [], "stdout": "CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001169", "stdout_lines": ["CURL_STATUS_CODE:000;CURL_TIME_TOTAL:0.001169"], "website_item": {"ansible_check_mode": false, "ansible_config_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/ansible.cfg", "ansible_diff_mode": false, "ansible_facts": {}, "ansible_forks": 5, "ansible_inventory_sources": ["/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml"], "ansible_playbook_python": "/opt/pipx/venvs/ansible-core/bin/python", "ansible_run_tags": ["all"], "ansible_skip_tags": [], "ansible_verbosity": 1, "ansible_version": {"full": "2.18.7", "major": 2, "minor": 18, "revision": 7, "string": "2.18.7"}, "expected_status": 200, "group_names": ["test_websites"], "groups": {"all": ["proxy1", "proxy2", "proxy3", "direct_test", "google", "github", "baidu", "httpbin"], "proxy_servers": ["proxy1", "proxy2", "proxy3", "direct_test"], "test_websites": ["google", "github", "baidu", "httpbin"], "ungrouped": []}, "inventory_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory", "inventory_file": "/home/runner/work/monitor-webhtml/monitor-webhtml/inventory/hosts.yml", "inventory_hostname": "httpbin", "inventory_hostname_short": "httpbin", "playbook_dir": "/home/runner/work/monitor-webhtml/monitor-webhtml/playbooks", "request_timeout": 5, "test_url": "https://httpbin.org/status/200"}}
2025-08-13 23:01:07,608 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **********************************
2025-08-13 23:01:07,801 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=0) => {"ansible_facts": {"failed_count": "1", "proxy_tests": [{"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 0}
2025-08-13 23:01:07,970 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=1) => {"ansible_facts": {"failed_count": "2", "proxy_tests": [{"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "0", "curl_status_code": "200", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 1}
2025-08-13 23:01:08,141 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=2) => {"ansible_facts": {"failed_count": "3", "proxy_tests": [{"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "0", "curl_status_code": "200", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 2}
2025-08-13 23:01:08,311 p=6540 u=runner n=ansible INFO| ok: [localhost] => (item=3) => {"ansible_facts": {"failed_count": "4", "proxy_tests": [{"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "0", "curl_status_code": "200", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "successful_count": "0"}, "ansible_loop_var": "item_index", "changed": false, "item_index": 3}
2025-08-13 23:01:08,318 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **********************************
2025-08-13 23:01:08,339 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=0)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 0, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:08,341 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=1)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 1, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:08,343 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=2)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 2, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:08,346 p=6540 u=runner n=ansible INFO| skipping: [localhost] => (item=3)  => {"ansible_loop_var": "item_index", "changed": false, "false_condition": "ansible_check_mode and website_test_result.results is not defined", "item_index": 3, "skip_reason": "Conditional result was False"}
2025-08-13 23:01:08,346 p=6540 u=runner n=ansible INFO| skipping: [localhost] => {"changed": false, "msg": "All items skipped"}
2025-08-13 23:01:08,352 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] ******************************************
2025-08-13 23:01:08,370 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_success_rate": "0.0"}, "changed": false}
2025-08-13 23:01:08,376 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ****************************************
2025-08-13 23:01:08,393 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_status": "UNHEALTHY"}, "changed": false}
2025-08-13 23:01:08,398 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ****************************************
2025-08-13 23:01:08,424 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"proxy_test_results": {"direct_test": {"failed_tests": "4", "proxy_name": "direct_test", "proxy_url": "", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "0", "curl_status_code": "200", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:01:02Z", "total_tests": 4}, "proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:01:02Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:01:02Z", "total_tests": 4}}}, "changed": false}
2025-08-13 23:01:08,433 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ********************************************
2025-08-13 23:01:08,998 p=6540 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "8335b131f19b0c1b4b3135c876df174de8854697", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log", "gid": 118, "group": "docker", "md5sum": "2b2fd4b6a5543bbd6fe283f4d0a7451b", "mode": "0644", "owner": "runner", "size": 3162, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755126068.4460146-7016-257211007546994/.source.log", "state": "file", "uid": 1001}
2025-08-13 23:01:09,005 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ****************************************
2025-08-13 23:01:09,040 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"failed_proxies": [], "monitoring_results": [{"direct_test": {"failed_tests": "4", "proxy_name": "direct_test", "proxy_url": "", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "0", "curl_status_code": "200", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 0)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "6", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 6)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:01:02Z", "total_tests": 4}, "proxy1": {"failed_tests": "4", "proxy_name": "proxy1", "proxy_url": "http://proxy1.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:01:02Z", "total_tests": 4}, "proxy2": {"failed_tests": "4", "proxy_name": "proxy2", "proxy_url": "http://proxy2.example.com:8080", "status": "UNHEALTHY", "success_rate": "0.0", "successful_tests": "0", "test_details": [{"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.google.com", "website": "google"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://github.com", "website": "github"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://www.baidu.com", "website": "baidu"}, {"debug_info": {"curl_return_code": "5", "curl_status_code": "000", "is_curl_success": false, "is_http_success": false, "status_codes_success": [200, 201, 202, 204, 301, 302, 304]}, "error_msg": "curl执行失败 (返回码: 5)", "response_time": "-1", "status": "FAILED", "status_code": "-1", "timestamp": "2025-08-13T23:01:02Z", "url": "https://httpbin.org/status/200", "website": "httpbin"}], "timestamp": "2025-08-13T23:01:02Z", "total_tests": 4}}], "successful_tests": "NotImplemented", "total_tests": "12"}, "changed": false}
2025-08-13 23:01:09,050 p=6540 u=runner n=ansible INFO| TASK [计算总体统计信息] ********************************************************
2025-08-13 23:01:09,071 p=6540 u=runner n=ansible INFO| ok: [localhost] => {"ansible_facts": {"overall_success_rate": "0.0", "total_failed_proxies": "0"}, "changed": false}
2025-08-13 23:01:09,076 p=6540 u=runner n=ansible INFO| TASK [显示监控汇总] ************************************************************
2025-08-13 23:01:09,090 p=6540 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T23:01:02Z",
        "总测试次数: 12",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 23:01:09,096 p=6540 u=runner n=ansible INFO| TASK [发送告警邮件] ************************************************************
2025-08-13 23:01:09,139 p=6540 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:01:09,146 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ****************************************
2025-08-13 23:01:09,524 p=6540 u=runner n=ansible INFO| changed: [localhost] => {"changed": true, "checksum": "98fcb98a08f3838a9301d43d178b8360ad132fdb", "dest": "/home/runner/work/monitor-webhtml/monitor-webhtml/logs/alert_email.html", "gid": 118, "group": "docker", "md5sum": "cf53af8a6cc8a323444513c8e998e14c", "mode": "0644", "owner": "runner", "size": 12154, "src": "/home/runner/.ansible/tmp/ansible-tmp-1755126069.1595073-7059-3766100474413/.source.html", "state": "file", "uid": 1001}
2025-08-13 23:01:09,531 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ********************************************
2025-08-13 23:01:09,833 p=6540 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 23:01:09,833 p=6540 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126069.5530314-7098-214034841942298/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126069.5530314-7098-214034841942298/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126069.5530314-7098-214034841942298/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_ee1nfkqy/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_ee1nfkqy/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 23:01:09,833 p=6540 u=runner n=ansible INFO| ...ignoring
2025-08-13 23:01:09,839 p=6540 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ****************************************
2025-08-13 23:01:09,860 p=6540 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 23:01:09,871 p=6540 u=runner n=ansible INFO| TASK [监控状态总结] ************************************************************
2025-08-13 23:01:09,883 p=6540 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 23:01:09,884 p=6540 u=runner n=ansible INFO| PLAY RECAP *********************************************************************
2025-08-13 23:01:09,884 p=6540 u=runner n=ansible INFO| localhost                  : ok=40   changed=5    unreachable=0    failed=0    skipped=3    rescued=0    ignored=1   
2025-08-13 23:02:01,143 p=7134 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 23:02:01,148 p=7134 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 23:02:02,043 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:02,047 p=7134 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 23:02:02,308 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:02,315 p=7134 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 23:02:02,323 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:02,328 p=7134 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 23:02:02,348 p=7134 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:02:02,353 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 23:02:02,379 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:02,384 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 23:02:02,406 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:02,412 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 23:02:02,422 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:02,429 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 23:02:02,455 p=7134 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 23:02:02,459 p=7134 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 23:02:02,463 p=7134 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=direct_test)
2025-08-13 23:02:02,469 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:02:02,481 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:02,486 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 23:02:02,505 p=7134 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy1 (http://proxy1.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:02:02,511 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:02:02,785 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 23:02:02,970 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 23:02:03,150 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 23:02:03,347 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 23:02:03,354 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:02:03,489 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 23:02:03,601 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 23:02:03,713 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 23:02:03,824 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 23:02:03,831 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:02:03,854 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 23:02:03,857 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 23:02:03,860 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 23:02:03,863 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 23:02:03,864 p=7134 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 23:02:03,871 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 23:02:03,890 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:03,895 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 23:02:03,911 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:03,917 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:02:03,936 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:03,942 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:02:03,953 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:03,959 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 23:02:03,977 p=7134 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy2 (http://proxy2.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:02:03,983 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:02:04,189 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 23:02:04,374 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 23:02:04,561 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 23:02:04,753 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 23:02:04,760 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:02:04,897 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 23:02:05,008 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 23:02:05,119 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 23:02:05,229 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 23:02:05,236 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:02:05,258 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 23:02:05,260 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 23:02:05,263 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 23:02:05,265 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 23:02:05,266 p=7134 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 23:02:05,272 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 23:02:05,292 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:05,298 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 23:02:05,315 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:05,321 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:02:05,343 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:05,352 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:02:05,363 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:05,368 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 23:02:05,386 p=7134 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: direct_test ()",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:02:05,392 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:02:05,595 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 23:02:05,928 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 23:02:06,110 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 23:02:06,290 p=7134 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 23:02:06,298 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:02:06,431 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 23:02:06,544 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 23:02:06,655 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 23:02:06,766 p=7134 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 23:02:06,773 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:02:06,795 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 23:02:06,797 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 23:02:06,800 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 23:02:06,802 p=7134 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 23:02:06,803 p=7134 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 23:02:06,809 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 23:02:06,827 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:06,833 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 23:02:06,849 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:06,855 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:02:06,876 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:06,882 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 23:02:07,445 p=7134 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 23:02:07,451 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 23:02:07,484 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:07,495 p=7134 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 23:02:07,514 p=7134 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:02:07,519 p=7134 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 23:02:07,533 p=7134 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T23:02:01Z",
        "总测试次数: 12",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 23:02:07,538 p=7134 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 23:02:07,581 p=7134 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:02:07,588 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 23:02:07,946 p=7134 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 23:02:07,952 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 23:02:08,235 p=7134 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 23:02:08,235 p=7134 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126127.9741762-7690-135669647315408/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126127.9741762-7690-135669647315408/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126127.9741762-7690-135669647315408/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_4kotp8rr/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_4kotp8rr/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 23:02:08,235 p=7134 u=runner n=ansible INFO| ...ignoring
2025-08-13 23:02:08,241 p=7134 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 23:02:08,260 p=7134 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 23:02:08,270 p=7134 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 23:02:08,282 p=7134 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 23:02:08,283 p=7134 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 23:02:08,283 p=7134 u=runner n=ansible INFO| localhost                  : ok=40   changed=5    unreachable=0    failed=0    skipped=3    rescued=0    ignored=1   
2025-08-13 23:03:05,280 p=7723 u=runner n=ansible INFO| PLAY [代理状态和网站连通性监控] ****************************************************************************************
2025-08-13 23:03:05,286 p=7723 u=runner n=ansible INFO| TASK [Gathering Facts] *************************************************************************************************
2025-08-13 23:03:06,163 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:06,168 p=7723 u=runner n=ansible INFO| TASK [创建日志目录] ****************************************************************************************************
2025-08-13 23:03:06,425 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:06,430 p=7723 u=runner n=ansible INFO| TASK [初始化监控结果变量] **********************************************************************************************
2025-08-13 23:03:06,438 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:06,443 p=7723 u=runner n=ansible INFO| TASK [执行代理监控任务] ************************************************************************************************
2025-08-13 23:03:06,463 p=7723 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:03:06,468 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 获取已启用的代理服务器列表] **********************************************************************
2025-08-13 23:03:06,495 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:06,500 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 获取测试网站列表] ********************************************************************************
2025-08-13 23:03:06,523 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:06,528 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化测试结果] **********************************************************************************
2025-08-13 23:03:06,538 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:06,545 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 对每个代理执行网站连通性测试] ********************************************************************
2025-08-13 23:03:06,570 p=7723 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy1)
2025-08-13 23:03:06,574 p=7723 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=proxy2)
2025-08-13 23:03:06,578 p=7723 u=runner n=ansible INFO| included: /home/runner/work/monitor-webhtml/monitor-webhtml/roles/proxy-monitor/tasks/test_proxy.yml for localhost => (item=direct_test)
2025-08-13 23:03:06,584 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:03:06,594 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:06,599 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 23:03:06,616 p=7723 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy1 (http://proxy1.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:03:06,621 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:03:06,901 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 23:03:07,089 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 23:03:07,269 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 23:03:07,464 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 23:03:07,471 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:03:07,605 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 23:03:07,717 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 23:03:07,831 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 23:03:07,945 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 23:03:07,952 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:03:07,974 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 23:03:07,976 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 23:03:07,979 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 23:03:07,981 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 23:03:07,982 p=7723 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 23:03:07,989 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 23:03:08,007 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:08,013 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 23:03:08,029 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:08,035 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:03:08,055 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:08,061 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:03:08,073 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:08,078 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 23:03:08,096 p=7723 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: proxy2 (http://proxy2.example.com:8080)",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:03:08,102 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:03:08,309 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 23:03:08,492 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 23:03:08,682 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 23:03:08,864 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 23:03:08,872 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:03:09,009 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 23:03:09,124 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 23:03:09,237 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 23:03:09,350 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 23:03:09,357 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:03:09,378 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 23:03:09,380 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 23:03:09,383 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 23:03:09,385 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 23:03:09,386 p=7723 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 23:03:09,392 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 23:03:09,411 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:09,416 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 23:03:09,433 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:09,438 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:03:09,462 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:09,470 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 初始化代理测试结果] ******************************************************************************
2025-08-13 23:03:09,481 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:09,487 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 显示代理测试状态] ********************************************************************************
2025-08-13 23:03:09,504 p=7723 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "正在测试代理: direct_test ()",
        "代理启用状态: True",
        "待测试网站数量: 4"
    ]
}
2025-08-13 23:03:09,510 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 测试代理对各网站的连通性] ************************************************************************
2025-08-13 23:03:09,713 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=google)
2025-08-13 23:03:10,212 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=github)
2025-08-13 23:03:10,396 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=baidu)
2025-08-13 23:03:10,581 p=7723 u=runner n=ansible INFO| changed: [localhost] => (item=httpbin)
2025-08-13 23:03:10,589 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 处理每个网站的测试结果] **************************************************************************
2025-08-13 23:03:10,724 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=0)
2025-08-13 23:03:10,842 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=1)
2025-08-13 23:03:10,957 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=2)
2025-08-13 23:03:11,073 p=7723 u=runner n=ansible INFO| ok: [localhost] => (item=3)
2025-08-13 23:03:11,080 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 处理检查模式的测试结果] **************************************************************************
2025-08-13 23:03:11,102 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=0) 
2025-08-13 23:03:11,104 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=1) 
2025-08-13 23:03:11,107 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=2) 
2025-08-13 23:03:11,110 p=7723 u=runner n=ansible INFO| skipping: [localhost] => (item=3) 
2025-08-13 23:03:11,111 p=7723 u=runner n=ansible INFO| skipping: [localhost]
2025-08-13 23:03:11,117 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 计算代理成功率] **********************************************************************************
2025-08-13 23:03:11,135 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:11,141 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 判断代理整体状态] ********************************************************************************
2025-08-13 23:03:11,157 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:11,162 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 存储代理测试结果] ********************************************************************************
2025-08-13 23:03:11,182 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:11,188 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 生成监控日志] ************************************************************************************
2025-08-13 23:03:11,740 p=7723 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 23:03:11,747 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 更新全局监控结果] ********************************************************************************
2025-08-13 23:03:11,781 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:11,793 p=7723 u=runner n=ansible INFO| TASK [计算总体统计信息] ************************************************************************************************
2025-08-13 23:03:11,812 p=7723 u=runner n=ansible INFO| ok: [localhost]
2025-08-13 23:03:11,818 p=7723 u=runner n=ansible INFO| TASK [显示监控汇总] ****************************************************************************************************
2025-08-13 23:03:11,831 p=7723 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": [
        "监控完成时间: 2025-08-13T23:03:05Z",
        "总测试次数: 12",
        "成功测试: NotImplemented",
        "总体成功率: 0.0%",
        "失败代理数量: 0"
    ]
}
2025-08-13 23:03:11,837 p=7723 u=runner n=ansible INFO| TASK [发送告警邮件] ****************************************************************************************************
2025-08-13 23:03:11,879 p=7723 u=runner n=ansible INFO| included: proxy-monitor for localhost
2025-08-13 23:03:11,886 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 生成HTML告警邮件] ********************************************************************************
2025-08-13 23:03:12,254 p=7723 u=runner n=ansible INFO| changed: [localhost]
2025-08-13 23:03:12,260 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 发送告警邮件] ************************************************************************************
2025-08-13 23:03:12,544 p=7723 u=runner n=ansible INFO| An exception occurred during task execution. To see the full traceback, use -vvv. The error was: socket.gaierror: [Errno -5] No address associated with hostname
2025-08-13 23:03:12,544 p=7723 u=runner n=ansible INFO| fatal: [localhost]: FAILED! => {"changed": false, "module_stderr": "Traceback (most recent call last):\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126192.281418-8279-96207205409732/AnsiballZ_mail.py\", line 107, in <module>\n    _ansiballz_main()\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126192.281418-8279-96207205409732/AnsiballZ_mail.py\", line 99, in _ansiballz_main\n    invoke_module(zipped_mod, temp_path, ANSIBALLZ_PARAMS)\n  File \"/home/runner/.ansible/tmp/ansible-tmp-1755126192.281418-8279-96207205409732/AnsiballZ_mail.py\", line 47, in invoke_module\n    runpy.run_module(mod_name='ansible_collections.community.general.plugins.modules.mail', init_globals=dict(_module_fqn='ansible_collections.community.general.plugins.modules.mail', _modlib_path=modlib_path),\n  File \"<frozen runpy>\", line 226, in run_module\n  File \"<frozen runpy>\", line 98, in _run_module_code\n  File \"<frozen runpy>\", line 88, in _run_code\n  File \"/tmp/ansible_mail_payload_a9qplxbq/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 428, in <module>\n  File \"/tmp/ansible_mail_payload_a9qplxbq/ansible_mail_payload.zip/ansible_collections/community/general/plugins/modules/mail.py\", line 307, in main\n  File \"/usr/lib/python3.12/smtplib.py\", line 255, in __init__\n    (code, msg) = self.connect(host, port)\n                  ^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 341, in connect\n    self.sock = self._get_socket(host, port, self.timeout)\n                ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/smtplib.py\", line 312, in _get_socket\n    return socket.create_connection((host, port), timeout,\n           ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 828, in create_connection\n    for res in getaddrinfo(host, port, 0, SOCK_STREAM):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\n  File \"/usr/lib/python3.12/socket.py\", line 963, in getaddrinfo\n    for res in _socket.getaddrinfo(host, port, family, type, proto, flags):\n               ^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^^\nsocket.gaierror: [Errno -5] No address associated with hostname\n", "module_stdout": "", "msg": "MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error", "rc": 1}
2025-08-13 23:03:12,545 p=7723 u=runner n=ansible INFO| ...ignoring
2025-08-13 23:03:12,550 p=7723 u=runner n=ansible INFO| TASK [proxy-monitor : 记录邮件发送结果] ********************************************************************************
2025-08-13 23:03:12,569 p=7723 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "告警邮件发送失败: MODULE FAILURE: No start of json char found\nSee stdout/stderr for the exact error"
}
2025-08-13 23:03:12,579 p=7723 u=runner n=ansible INFO| TASK [监控状态总结] ****************************************************************************************************
2025-08-13 23:03:12,590 p=7723 u=runner n=ansible INFO| ok: [localhost] => {
    "msg": "代理监控周期已完成。详细日志请查看: /home/runner/work/monitor-webhtml/monitor-webhtml/logs/proxy_monitor.log"
}
2025-08-13 23:03:12,591 p=7723 u=runner n=ansible INFO| PLAY RECAP *************************************************************************************************************
2025-08-13 23:03:12,591 p=7723 u=runner n=ansible INFO| localhost                  : ok=40   changed=5    unreachable=0    failed=0    skipped=3    rescued=0    ignored=1   
